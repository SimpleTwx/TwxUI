<!DOCTYPE html>
<html>
<head>
    <link href="../Lib/winbox/dist/css/winbox.min.css" rel="stylesheet" />
    <script src="../lib/winbox/dist/js/winbox.min.js"></script>
    <!--<script>
        //  默认实现
        var twx_default = {
            //  判断访问端实现:"手机、平板、电脑"
            isPlatform: function () {
                var ua = navigator.userAgent,
                    isWindowsPhone = /(?:Windows Phone)/.test(ua),
                    isSymbian = /(?:SymbianOS)/.test(ua) || isWindowsPhone,
                    isAndroid = /(?:Android)/.test(ua),
                    isFireFox = /(?:Firefox)/.test(ua),
                    isChrome = /(?:Chrome|CriOS)/.test(ua),
                    isTablet = /(?:iPad|PlayBook)/.test(ua) || (isAndroid && !/(?:Mobile)/.test(ua)) || (isFireFox && /(?:Tablet)/.test(ua)) || (isChrome && /(?:Tablet)/.test(ua)),
                    isPhone = /(?:iPhone)/.test(ua) && !isTablet,
                    isPc = !isPhone && !isAndroid && !isSymbian;
                return (isAndroid || isPhone) ? "手机" : (isTablet ? "平板" : (isPc ? "电脑" : ""));
            }
        };
        switch (twx_default.isPlatform()) {
            case "手机":
            case "平板":
            case "电脑":
                alert("没有访问权限");
                window.location.href = "https://www.baidu.com/";
                break;
            default:
                break;
        }
    </script>-->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <title>Scada 组态</title>
    <link href="../Lib/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../Lib/bootstrap-4.5.0-dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../Css/twxDrag.css" rel="stylesheet" />
</head>
<!--<body oncontextmenu="return false">-->
<body>
    <div class="twx-drag-container">
        <div class="twx-aside" style="display: flex;flex-direction: column;">
            <ul class="twx-ul-nav" style="box-shadow: 0 0 6px #000;">
                <li style="width: 100%;font-size:1.4rem;background-color: #274677;">
                    <table>
                        <tbody>
                            <tr>
                                <td>
                                    <div>
                                        <img src="../images/logo/Title.png" />
                                    </div>
                                </td>
                                <td>
                                    Scada 组态
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </li>
            </ul>
            <div class="none-select full-flex">
                <div class="twxDrag-panel" id="drag-panel"></div>
                <div class="twxDrag-panel" id="project-panel"></div>
            </div>
        </div>
        <div class="twx-drag-container is-vertical">
            <div class="twx-header">
                <ul class="twx-ul-nav" id="twx-menu-fade">
                    <li>
                        <table>
                            <tbody>
                                <tr>
                                    <td><div><i class="fa fa-file-text fa-lg"></i></div></td>
                                    <td><div>文件</div></td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="drop-down">
                            <ul>
                                <li class="border-bottom">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td>打开项目</td>
                                                <td>Ctrl + O</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </li>
                                <li>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td>保存</td>
                                                <td>Ctrl + S</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </li>
                                <li class="border-bottom">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td>另存为...</td>
                                                <td>Ctrl + Shift + S</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </li>
                                <li>
                                    <a href="config.html" style="outline:none;cursor:pointer;color:inherit;">
                                        <table>
                                            <tbody>
                                                <tr>
                                                    <td>组态统一配置</td>
                                                    <td></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <table>
                            <tbody>
                                <tr>
                                    <td><div><i class="fa fa-clipboard fa-lg"></i></div></td>
                                    <td><div>编辑</div></td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="drop-down">
                            <ul>
                                <li>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td>撤消</td>
                                                <td>Ctrl + Z</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </li>
                                <li class="border-bottom">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td>恢复</td>
                                                <td>Ctrl + Y</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </li>
                                <li>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td>剪切</td>
                                                <td>Ctrl + X</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </li>
                                <li>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td>拷贝</td>
                                                <td>Ctrl + C</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </li>
                                <li>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td>粘贴</td>
                                                <td>Ctrl + V</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </li>
                                <li>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td>删除</td>
                                                <td>Del</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </li>
                                <li class="border-bottom">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td>全选</td>
                                                <td>Ctrl + A</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </li>
                                <li>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td>清空</td>
                                                <td>Ctrl + O</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </li>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <table>
                            <tbody>
                                <tr>
                                    <td><div><i class="fa fa-question-circle fa-lg"></i></div></td>
                                    <td><div>帮助</div></td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="drop-down">
                            <ul>
                                <li>开发文档</li>
                                <li>关于</li>
                            </ul>
                        </div>
                    </li>
                </ul>
                <ul class="twx-ul-nav">
                    <li class="panel-menu" menu-type="panel-zoom-minus">
                        <table>
                            <tbody>
                                <tr>
                                    <td><div><i class="fa fa-minus fa-lg" style="padding-right:0;"></i></div></td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                    <li>
                        <table>
                            <tbody>
                                <tr>
                                    <td><div class="panel-zoom" style="width:3.6rem;">100%</div></td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                    <li class="panel-menu" menu-type="panel-zoom-plus">
                        <table>
                            <tbody>
                                <tr>
                                    <td><div><i class="fa fa-plus fa-lg" style="padding-right:0;"></i></div></td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                    <li class="panel-menu" menu-type="panel-zoom-reset">
                        <table>
                            <tbody>
                                <tr>
                                    <td><div>重置</div></td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                </ul>
                <ul class="twx-ul-nav panel-page" style="visibility:hidden;">
                    <li style="padding:0 10px;">
                        <table>
                            <tbody>
                                <tr>
                                    <td>尺寸：</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="drop-down">
                            <ul class="page-size">
                                <li>1024×768</li>
                                <li>1366×768</li>
                                <li>1280×800</li>
                                <li>1440×900</li>
                                <li>1600×900</li>
                                <li>1920×1080</li>
                                <li>2048×1024</li>
                                <li>3840×2160</li>
                                <li>4096×2160</li>
                            </ul>
                        </div>
                    </li>
                    <li style="padding:0 5px;">
                        <table>
                            <tbody>
                                <tr>
                                    <td><div class="flex"><input type="text" type-name="width" /><span>×</span><input type-name="height" type="text" /></div></td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                </ul>
                <ul class="twx-ul-nav">
                    <li class="panel-menu" menu-type="panel-view">
                        <table>
                            <tbody>
                                <tr>
                                    <td><div><i class="fa fa-eye fa-lg"></i></div></td>
                                    <td><div>预览</div></td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                    <li class="panel-menu" menu-type="panel-download">
                        <table>
                            <tbody>
                                <tr>
                                    <td><div><i class="fa fa-download fa-lg"></i></div></td>
                                    <td><div>下载</div></td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                    <li>
                        <table>
                            <tbody>
                                <tr>
                                    <td><div><i class="fa fa-user fa-lg"></i></div></td>
                                    <td><div>Admin</div></td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="drop-down" style="right:0;left:auto;min-width:16rem;">
                            <ul>
                                <!--<li><i class="fa fa-vcard-o fa-lg" style="text-align: center;width:30px;"></i>个人信息</li>-->
                                <li class="exit-login"><i class="fa fa-sign-out fa-lg" style="text-align: center;width:3rem;"></i>退出</li>
                            </ul>
                        </div>
                    </li>
                </ul>
            </div>
            <style>
                .twxui-ul-field {
                    list-style: none;
                    float: left;
                    margin: 5px 0;
                    padding: 0 5px;
                    font-size: 1.2rem;
                    border-right: 1px solid #192c4f;
                    color: #fff;
                }

                    .twxui-ul-field li {
                        position: relative;
                        list-style: none;
                        float: left;
                        cursor: pointer;
                        padding: 0 5px;
                    }

                        .twxui-ul-field li:hover {
                            color: #24c8ea;
                        }

                        .twxui-ul-field li:first-child {
                            color: #b7daff;
                            cursor: text;
                        }
                    /*工具箱*/
                    .twxui-ul-field .twxui-tool-lock {
                        color: #333;
                        cursor: text;
                    }

                        .twxui-ul-field .twxui-tool-lock:hover {
                            color: #333;
                        }

                    .twxui-ul-field:last-child {
                        border-right: none;
                    }
            </style>
            <div style="border-bottom: 1px solid #192c4f;padding:0;display:flex;line-height:19px;">
                <ul class="twxui-ul-field">
                    <li>
                        <span><i class="fa fa-map-marker" aria-hidden="true" style="padding-right:5px;"></i> 对齐方式 :</span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="align-left" title="左对齐">
                        <span><i class="fa fa-align-left" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="align-right" title="右对齐">
                        <span><i class="fa fa-align-right" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="align-top" title="上对齐">
                        <span><i class="fa fa-align-left rotate-90" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="align-bottom" title="下对齐">
                        <span><i class="fa fa-align-right rotate-90" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="align-center" title="水平居中">
                        <span><i class="fa fa-align-center" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="align-middle" title="垂直居中">
                        <span><i class="fa fa-align-center rotate-90" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="align-center-middle" title="中心对齐">
                        <span><i class="fa fa-align-justify" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="width" title="等宽">
                        <span><i class="fa fa-arrows-h" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="height" title="等高">
                        <span><i class="fa fa-arrows-v" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="width-height" title="相同大小">
                        <span><i class="fa fa-arrows" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="space-width" title="等水平间距">
                        <span><i class="fa fa-text-width" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="space-height" title="等垂直间距">
                        <span><i class="fa fa-text-height" aria-hidden="true"></i></span>
                    </li>
                </ul>
                <ul class="twxui-ul-field">
                    <li>
                        <span><i class="fa fa-briefcase" aria-hidden="true" style="padding-right:5px;"></i> 排列 :</span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="group" title="组合">
                        <span><i class="fa fa-object-group" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="ungroup" title="解组">
                        <span><i class="fa fa-object-ungroup" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="lock" title="锁定">
                        <span><i class="fa fa-unlock-alt" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="unlock" title="解锁">
                        <span><i class="fa fa-unlock" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="copy" title="多重复制">
                        <span><i class="fa fa-th" aria-hidden="true"></i></span>
                    </li>
                </ul>
                <ul class="twxui-ul-field">
                    <li>
                        <span><i class="fa fa-shield" aria-hidden="true" style="padding-right:5px;"></i> 工具 :</span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="font" title="字体同步">
                        <span><i class="fa fa-font" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="tips" title="辅助提示">
                        <span><i class="fa fa-podcast" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="unselect" title="不可选">
                        <span><i class="fa fa-eye-slash" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="select" title="全部可选">
                        <span><i class="fa fa-eye" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="check" title="安全检查">
                        <span><i class="fa fa-bug" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="undo" title="撤消">
                        <span><i class="fa fa-reply" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool twxui-tool-lock" tool-type="reply" title="恢复">
                        <span><i class="fa fa-share" aria-hidden="true"></i></span>
                    </li>
                </ul>
                <ul class="twxui-ul-field">
                    <li>
                        <span><i class="fa fa-copyright" aria-hidden="true" style="padding-right:5px;"></i> 扩展 :</span>
                    </li>
                    <li class="twxui-tool" tool-type="layout" title="页面分辨率">
                        <span><i class="fa fa-window-maximize" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool" tool-type="language" title="多语言">
                        <span><i class="fa fa-language" aria-hidden="true"></i></span>
                    </li>
                    <li class="twxui-tool" tool-type="qrcode" title="页面二维码">
                        <span><i class="fa fa-qrcode" aria-hidden="true"></i></span>
                    </li>
                </ul>
            </div>
            <style>
                .panel-field {
                    display: flex;
                    flex-wrap: wrap;
                }
                    /*属性分类名称*/
                    .panel-field .panel-field-title {
                        display: flex;
                        flex-wrap: wrap;
                        width: 100%;
                        box-shadow: 0 0 6px #000;
                    }

                        .panel-field .panel-field-title span {
                            padding: 4px 18px 0 18px;
                            padding-bottom: 4px;
                            border-bottom: 2px solid rgba(0,0,0,0);
                            cursor: pointer;
                            display: none;
                        }

                            .panel-field .panel-field-title span:first-child {
                                display: inline-block;
                            }

                            .panel-field .panel-field-title span.open {
                                display: inline-block;
                            }

                            .panel-field .panel-field-title span:hover {
                                font-weight: 600;
                                border-bottom-color: #3ea5ea;
                                color: #b7daff;
                            }

                            .panel-field .panel-field-title span.active {
                                font-weight: 600;
                                border-bottom-color: #3ea5ea;
                                color: #b7daff;
                            }
                    /*分类属性具体内容*/
                    .panel-field .panel-field-info {
                        display: flex;
                        flex-wrap: wrap;
                        width: 100%;
                        padding: 0 10px 10px 10px;
                    }

                        .panel-field .panel-field-info .field-name {
                            width: 100%;
                            padding: 10px 5px 5px;
                            color: #b7daff;
                        }

                        .panel-field .panel-field-info .field-info {
                            display: flex;
                            flex-wrap: wrap;
                            justify-content: space-between;
                            width: 100%;
                            padding: 0 10px;
                        }

                            .panel-field .panel-field-info .field-info .child {
                                display: flex;
                                flex-wrap: nowrap;
                                align-items: center;
                                margin-bottom: 4px;
                                width: 100%;
                                justify-content: space-between;
                                justify-content: space-between;
                            }

                                .panel-field .panel-field-info .field-info .child .div-td button {
                                    width: 40px;
                                    font-size: 1.2rem;
                                    border: 2px solid #b7daff;
                                    color: #b7daff;
                                    background: none;
                                }

                                    .panel-field .panel-field-info .field-info .child .div-td button:hover,
                                    .panel-field .panel-field-info .field-info .child .div-td button:focus {
                                        outline: none;
                                    }

                                    .panel-field .panel-field-info .field-info .child .div-td button:active {
                                        border: 2px solid #fac600;
                                        color: #1a96ff;
                                        border-radius: 0;
                                    }

                                .panel-field .panel-field-info .field-info .child input {
                                    width: 100%;
                                    font-size: 1.2rem !important;
                                    margin-top: 1px;
                                    height: 22px !important;
                                    line-height: 22px;
                                    border: none;
                                    background: none;
                                    color: #b7daff;
                                    border: 1px solid rgba(26, 150, 255, 0.40);
                                }

                            .panel-field .panel-field-info .field-info .child-1 {
                                justify-content: space-between;
                            }

                                .panel-field .panel-field-info .field-info .child-1 .div-td:nth-child(1) {
                                    width: 70px;
                                    text-align: right;
                                }

                                .panel-field .panel-field-info .field-info .child-1 .div-td:nth-child(2) {
                                    width: 190px;
                                }

                            .panel-field .panel-field-info .field-info .child-2 {
                                width: 50%;
                                justify-content: flex-end;
                            }

                                .panel-field .panel-field-info .field-info .child-2 .div-td:nth-child(1) {
                                    width: 70px;
                                    text-align: right;
                                    padding-right: 5px;
                                }

                                .panel-field .panel-field-info .field-info .child-2 .div-td:nth-child(2) {
                                    width: 110px;
                                }

                            .panel-field .panel-field-info .field-info .child-4 {
                                width: 25%;
                            }

                                .panel-field .panel-field-info .field-info .child-4 .div-td:nth-child(odd) {
                                    width: 35px;
                                    text-align: right;
                                    padding-right: 5px;
                                }

                                .panel-field .panel-field-info .field-info .child-4 .div-td:nth-child(even) {
                                    width: 55px;
                                    text-align: left;
                                }

                            .panel-field .panel-field-info .field-info .child-type {
                                display: flex;
                                flex-wrap: wrap;
                                align-items: center;
                                margin-bottom: 4px;
                                width: 100%;
                                justify-content: space-around;
                            }

                                .panel-field .panel-field-info .field-info .child-type .div-td {
                                    padding: 5px 10px;
                                    cursor: pointer;
                                }

                                    .panel-field .panel-field-info .field-info .child-type .div-td span:nth-child(2) {
                                        padding: 4px;
                                    }

                                    .panel-field .panel-field-info .field-info .child-type .div-td span i {
                                        width: 16px;
                                    }

                                    .panel-field .panel-field-info .field-info .child-type .div-td:hover {
                                        background-color: rgba(0, 148, 255, 0.10);
                                    }

                            .panel-field .panel-field-info .field-info .child-btn .div-td:nth-child(1) {
                                width: 70px;
                                text-align: right;
                                padding-right: 5px;
                            }

                            .panel-field .panel-field-info .field-info .child-btn .div-td:nth-child(2) {
                                width: 200px;
                            }

                            .panel-field .panel-field-info .field-info .child-btn-info {
                                display: flex;
                                flex-wrap: wrap;
                                align-items: center;
                                width: 100%;
                                justify-content: space-around;
                                align-content: flex-start;
                                height: 200px;
                                padding: 10px 5px;
                                overflow: auto;
                                border: 1px solid rgba(183, 218, 255, 0.20);
                            }

                                .panel-field .panel-field-info .field-info .child-btn-info .div-td:nth-child(1) {
                                    height: 100%;
                                    width: 85%;
                                    padding: 0 5px;
                                }

                                .panel-field .panel-field-info .field-info .child-btn-info .div-td:nth-child(2) {
                                    height: 100%;
                                    width: 15%;
                                    text-align: center;
                                    display: flex;
                                    flex-wrap: wrap;
                                    justify-content: space-around;
                                    align-content: flex-end;
                                    border-left: 1px solid rgba(26, 150, 255, 0.40);
                                }

                                .panel-field .panel-field-info .field-info .child-btn-info .div-btn {
                                    height: 100%;
                                    width: 100%;
                                    padding: 0 5px;
                                }

                                    .panel-field .panel-field-info .field-info .child-btn-info .div-btn .div-btn-info {
                                        display: flex;
                                        flex-wrap: wrap;
                                        align-items: center;
                                        width: 100%;
                                        justify-content: space-around;
                                        align-content: flex-start;
                                        padding: 2px;
                                    }

                                    .panel-field .panel-field-info .field-info .child-btn-info .div-btn .btn-info-2 div {
                                        width: 50%;
                                        padding: 0 2px;
                                    }

                                    .panel-field .panel-field-info .field-info .child-btn-info .div-btn .btn-info-3 div {
                                        width: 33.33%;
                                        padding: 0 2px;
                                    }

                            .panel-field .panel-field-info .field-info .child-alarm {
                                display: flex;
                                flex-wrap: wrap;
                                align-items: center;
                                width: 100%;
                                justify-content: space-around;
                                border-bottom: 1px solid rgba(26, 150, 255, 0.30);
                                text-align: center;
                            }

                                .panel-field .panel-field-info .field-info .child-alarm div {
                                    padding: 3px 5px;
                                    cursor: pointer;
                                    width: 40%;
                                }

                                .panel-field .panel-field-info .field-info .child-alarm:last-child {
                                    border-bottom: none;
                                }

                    .panel-field .colse {
                        display: none;
                    }

                    .panel-field .open {
                        display: block;
                    }

                .drop-down {
                    position: absolute;
                    top: 100%;
                    left: 0;
                    width: 100%;
                    color: #fff;
                    display: none;
                    z-index: 9999;
                    background-color: rgba(39, 70, 119, 1.00);
                    text-align: left;
                    white-space: nowrap; /*强制不换行*/
                }

                    .drop-down .drop-ul {
                        width: 100%;
                        margin-bottom: 0;
                    }

                        .drop-down .drop-ul li {
                            list-style: none;
                            width: 100%;
                            text-align: left;
                            padding: 4px 10px;
                            cursor: pointer;
                        }

                            .drop-down .drop-ul li:hover {
                                background-color: rgba(0, 148, 255, 0.10);
                                color: #1a96ff;
                            }

                .drop-parent {
                    position: relative;
                }

                    .drop-parent:hover .drop-down {
                        display: block;
                    }

                        .drop-parent:hover .drop-down .check-box {
                            display: flex;
                            flex-wrap: wrap;
                            align-items: center;
                            width: 100%;
                        }

                            .drop-parent:hover .drop-down .check-box .box-td {
                                width: 100%;
                                text-align: left;
                                padding: 4px 10px;
                                cursor: pointer;
                            }

                                .drop-parent:hover .drop-down .check-box .box-td span:first-child {
                                    padding-right: 10px;
                                }

                                .drop-parent:hover .drop-down .check-box .box-td:hover {
                                    background-color: rgba(0, 148, 255, 0.10);
                                    color: #1a96ff;
                                }

                .twxui-picker {
                    display: flex;
                }

                    .twxui-picker .div-array {
                        display: flex;
                        width: 100%;
                        height: 100%;
                        border-right: 2px dashed #f00;
                    }

                    .twxui-picker span {
                        width: 8px;
                        height: 100%;
                    }

                .twxui-picker-border {
                    height: 22px;
                    border: 1px solid rgba(26, 150, 255, 0.40);
                }
            </style>
            <div class="twx-main none-select">
                <div id="panel-area" style="width:100%;height:100%;overflow:auto;display: -webkit-box;">
                    <div id="panel-draw" style="position:relative;top:0;left:0;background-color:#495057;margin:auto;"></div>
                </div>
            </div>
        </div>
    </div>
    <script src="../Lib/jquery/jquery-3.6.0.min.js"></script>
    <script src="../Scripts/twxDrag.js"></script>
    <script>
        //  面板数据
        var panelData = {
            "config": {
                //  默认语言：中文 zh
                "language": "zh"
                //  访问终端：手机、平板、电脑
                , "platform": "phone、pad、pc"
                //  页面识别码
                , "pageGuid": ""
                //  是否生成页面二维码
                , "qrcode": false
                //  布局
                , layout: {}
            },
            "data": {}
        };
        //  步骤记录
        var panelDataHistory = [];  //  记录项目控件标签对象
        var panelDataHtml = [];     //  记录控件的html对象
        var zTree, rMenu;
        //  控件拖拽编辑
        var twxEditor = {
            //  控件编辑工具
            panelEditor: '<div class="panel-twx-edit"><div class="center-top"></div><div class="left-top"></div><div class="left-bottom"></div><div class="right-top"></div><div class="right-bottom"></div></div>'
            //  系统面板控件属性：根据不同的控件类型，获取指定的控件内容
            , getPanelDraw: function (type, obj) {
                //  编辑框内：根据标签属性判断
                panelData[obj.id] = {
                    css: {
                        width: "100px",
                        height: "30px"
                    }
                };
                var newId = (new Date()).getTime();
                switch (type) {
                    //  布局
                    case "layout":
                        $("body").append('<div id="hide-' + newId + '" style="position:fixed;top:0;width:100%;height:100%;overflow: hidden;background-color: rgba(204,204,204,0.3);"></div>');
                        var winbox = new WinBox({
                            title: "页面布局 md xl",
                            x: "center",
                            y: "center",
                            width: "400px",
                            height: "200px",
                            onclose: function () {
                                $("#hide-" + newId).remove();
                            },
                            html: '<div id="type-layout" style="height:100%;display:flex;flex-direction: column;color: #fff;"><div style="color:#fab056;padding: 0.75rem 1.25rem;"><h4>说明：一行最大尺寸为12列，列必须为整数</h4></div><div class="layer-body"><div>电脑：<input class="layer-input" type="text" name="name" value="" autocomplete="off"/></div><div>行高：<input class="layer-input" type="text" name="name" value="" autocomplete="off" placeholder="单位：px、%"/></div></div><div class="layer-btn" style="color:#fab056;padding: 0.75rem 1.25rem;display:flex;"><span btn-type="sure">确定</span><span btn-type="cancel">取消</span></div></div>'
                        });
                        $(".layer-input").eq(0).focus();
                        $("#type-layout").find(".layer-btn").find("span").off("click").on("click", function () {
                            var type = $(this).attr("btn-type");
                            var input = $(".layer-input");
                            var val, html;
                            var row;
                            switch (type) {
                                case "sure":
                                    val = input.eq(0).val().split(' ');
                                    panelData.config.layout[newId] = {
                                        r: val
                                        , h: input.eq(1).val()
                                    };
                                    row = panelData.config.layout[newId];
                                    html = '<div class="row" style="height:' + row.h + ';">';
                                    for (var i = 0; i < row.r.length; i++) {
                                        html += '<div class="col-' + row.r[i] + ' twx-col"></div>';
                                    }
                                    html += '</div>';
                                    //html = '<div class="row" style="height:' + input.eq(1).val() + ';">';
                                    //for (var i = 0; i < val0.length; i++) {
                                    //    html += '<div class="col-' + val3[i] + ' col-md-' + val2[i] + ' col-xl-' + val0[i] + ' twx-col"></div>';
                                    //}
                                    //html += '</div>';
                                    $(".twx-container").append(html);
                                    winbox.close();
                                    break;
                                default: break;
                            }
                        });
                        //panelData[obj.id] = {
                        //    id: obj.id
                        //    , css: { top: obj.top + "px" }
                        //};
                        //if ($("#panel-draw").find(".twx-container").length === 0) {
                        //    $("#panel-draw").append('<div class="container-fluid twx-container"><div class="row"><div class="col-4 twx-col"><img class="" src="../images/common/fengshan.png" /></div><div class="col-4 twx-col"><img class="" src="../images/common/fengshan.png" /></div><div class="col-4 twx-col"><img class="" src="../images/common/light-red.png" /></div><div class="col-4 twx-col"><img class="" src="../images/common/fengshan.png" /></div><div class="col-4 twx-col"><img class="" src="../images/common/fengshan.png" /></div></div></div>');
                        //}
                        break;
                    case "line":
                        //  曲线
                        $("#panel-draw").append('<div panel-id="' + obj.id + '" class="panel-twx twxui-echarts"></div>');
                        panelData[obj.id].css.top = obj.top + "px";
                        panelData[obj.id].css.left = obj.left + "px";
                        $('div[panel-id="' + obj.id + '"]').css(panelData[obj.id].css);
                        $('div[panel-id="' + obj.id + '"]').find(".panel-twx-table").css(panelData[obj.id].flex);
                        //  echarts 开源可视化图表
                        twxEcharts.draw("line", obj.id, null);
                        break;
                    default:
                        $("#panel-draw").append('<div panel-id="' + obj.id + '" class="panel-twx"><div class="panel-twx-table">' + "测试" + '</div></div>');
                        panelData[obj.id].css.top = obj.top + "px";
                        panelData[obj.id].css.left = obj.left + "px";
                        $('div[panel-id="' + obj.id + '"]').css(panelData[obj.id].css);
                        //$('div[panel-id="' + obj.id + '"]').find(".panel-twx-table").css(panelData[obj.id].flex);
                        break;
                }


                //  添加编辑框
                $('div[panel-id="' + obj.id + '"]').removeClass("panel-twx-sel").addClass("panel-twx-sel").append(twxEditor.panelEditor);

                //  是否选中控件标签，位置属性展示
                if ($("#panel-draw").find(".panel-twx-sel").length === 0) {
                    $(".panel-rect").hide();
                    $(".mouse-rect").show();
                }
                //  更新工具可使用状态
                //twxTool.useable();
                twxDrag.dragMonuse(obj.id);
            }
            //  系统面板
            , panelDrag: function () {
                //  移动标签
                $("#drag-panel").find(".child").on("mousedown", function (ev) {
                    var obj = $(this);
                    var e = ev || window.event;
                    e.preventDefault();
                    var left = e.clientX, top = e.clientY;
                    var id = new Date().getTime();
                    $("body").children(".panel-move").remove();
                    $("body").append('<div class="panel-move" id="' + id + '">' + obj.prop("outerHTML") + '</div>');
                    $("#" + id).css({
                        "top": Math.round(top - obj.width() / 2),
                        "left": Math.round(left - obj.height() / 2)
                    });
                    $(document).on("mousemove", function (ev) {
                        var e = ev || window.event;
                        var top = e.clientY - obj.width() / 2,
                            left = e.clientX - obj.height() / 2;
                        $("#" + id).css({
                            "top": Math.round(top) + "px",
                            "left": Math.round(left) + "px"
                        });
                        $("#panel-draw").off("mouseout").on("mouseout", function () {
                            $("#panel-draw").off("mouseenter");
                        });
                    }).on("mouseup", function () {
                        $("#" + id).remove();
                        $(document).off("mousemove").off("mouseup");
                        var realTop, realLeft;
                        $("#panel-draw").off("mouseenter").on("mouseenter", function (ev) {
                            var e = ev || window.event;
                            realTop = e.offsetY;
                            realLeft = e.offsetX;
                            if (realTop >= 0 && realTop <= $("#panel-draw").height() && realLeft >= 0 && realLeft <= $("#panel-draw").width()) {
                                //  清空所选控件标签
                                $("#panel-draw").find(".panel-twx-sel").removeClass("panel-twx-sel").removeClass("panel-twx-sel-label");
                                $('.panel-twx-edit').remove();
                                //  编辑框内：根据标签属性判断
                                twxEditor.getPanelDraw(obj.attr("panel-type"), {
                                    "id": id,
                                    "left": realLeft,
                                    "top": realTop
                                });
                            }
                            else {
                                //编辑框外
                                delete panelData[id];
                                if ($("#panel-draw").find(".panel-twx-sel").length === 0) {
                                    $(".panel-rect").hide();
                                    $(".mouse-rect").show();
                                }
                                else {
                                    var sel_id = $("#panel-draw").find(".panel-twx-sel").eq(0).attr("panel-id");
                                    //$(".panel-rect").find(".panel-type-name").text(obj.attr("panel-type"));
                                    //$(".panel-rect").find(".panel-id-no").text(sel_id);
                                }
                            }
                            $("#panel-draw").off("mouseenter");
                        });
                    });
                });
            }
            //  弹出层:{width:"300px",height:"200px",title:"",div:""}
            , layer: function (obj) {
                var newId = new Date().getTime();
                $("body").append('<div id="hide-' + newId + '" style="position:fixed;top:0;width:100%;height:100%;overflow: hidden;background-color: rgba(204,204,204,0.3);"></div>');
                return new WinBox({
                    title: obj.title,
                    x: "center",
                    y: "center",
                    width: obj.width,
                    height: obj.height,
                    onclose: function () {
                        $("#hide-" + newId).remove();
                    },
                    html: obj.div
                    //html: '<div id="type-layout" style="height:100%;display:flex;flex-direction: column;color: #fff;background: #192c4f;"><div class="layer-body"><div>宽度：<input class="layer-input" type="text" name="name" value="" autocomplete="off" placeholder="单位：px、%"/></div><div>高度：<input class="layer-input" type="text" name="name" value="" autocomplete="off" placeholder="单位：px、%"/></div><div>自适应：<input class="layer-input" type="text" name="name" value="" autocomplete="off"/></div><div>行高：<input class="layer-input" type="text" name="name" value="" autocomplete="off" placeholder="单位：px、%"/></div></div><div class="layer-btn" style="color:#fab056;padding: 0.75rem 1.25rem;display:flex;"><span btn-type="sure">确定</span><span btn-type="cancel">取消</span></div></div>'
                });
            }
            //  加载弹出层
            , layerLoad: function () {
                var newId = new Date().getTime();
                $("body").append('<div id="hide-' + newId + '" style="position:fixed;top:0;width:100%;height:100%;overflow: hidden;background-color: rgba(204,204,204,0.3);"></div>');
                return $('#hide-' + newId);
            }
        };

        //  工具箱
        var twxTool = {
            init: function () {
                //  编辑控件工具
                var tools = $(".twxui-tool");
                tools.off("click").on("click", function () {
                    var thiso = $(this);
                    var sel = $(".panel-twx-sel");
                    var ids = {};
                    for (var i = 0; i < sel.length; i++) {
                        ids[sel.eq(i).attr("panel-id")] = panelData[sel.eq(i).attr("panel-id")];
                    }
                    var tool_type = thiso.attr("tool-type");
                    //  坐标、大小
                    var left, top, width, height, groupFunc;
                    //  是否需要保存状态
                    var saveBool = false;
                    switch (tool_type) {
                        //  左对齐
                        case "align-left":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                left = panelData[$(".panel-twx-sel-label").attr("panel-id")].css.left;
                                $.each(ids, function (n, list) {
                                    list.css.left = left;
                                    $('div[panel-id="' + n + '"]').css("left", parseInt(list.css.left) + "px");
                                });
                                saveBool = true;
                            }
                            break;
                        //  右对齐
                        case "align-right":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                left = parseInt(panelData[$(".panel-twx-sel-label").attr("panel-id")].css.left) + parseInt(panelData[$(".panel-twx-sel-label").attr("panel-id")].css.width);
                                $.each(ids, function (n, list) {
                                    list.css.left = (left - parseInt(list.css["width"])) + "px";
                                    $('div[panel-id="' + n + '"]').css("left", parseInt(list.css.left) + "px");
                                });
                                saveBool = true;
                            }
                            break;
                        //  上对齐
                        case "align-top":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                top = panelData[$(".panel-twx-sel-label").attr("panel-id")].css.top;
                                $.each(ids, function (n, list) {
                                    list.css.top = top;
                                    $('div[panel-id="' + n + '"]').css("top", parseInt(list.css.top) + "px");
                                });
                                saveBool = true;
                            }
                            break;
                        //  下对齐
                        case "align-bottom":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                top = parseInt(panelData[$(".panel-twx-sel-label").attr("panel-id")].css.top) + parseInt(panelData[$(".panel-twx-sel-label").attr("panel-id")].css.height);
                                $.each(ids, function (n, list) {
                                    list.css.top = (top - parseInt(list.css["height"])) + "px";
                                    $('div[panel-id="' + n + '"]').css("top", parseInt(list.css.top) + "px");
                                });
                                saveBool = true;
                            }
                            break;
                        //  水平居中
                        case "align-center":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                left = parseInt(panelData[$(".panel-twx-sel-label").attr("panel-id")].css.left) + parseInt(panelData[$(".panel-twx-sel-label").attr("panel-id")].css.width) / 2;
                                $.each(ids, function (n, list) {
                                    list.css.left = (left - parseInt(list.css["width"]) / 2) + "px";
                                    $('div[panel-id="' + n + '"]').css("left", parseInt(list.css.left) + "px");
                                });
                                saveBool = true;
                            }
                            break;
                        //  垂直居中
                        case "align-middle":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                top = parseInt(panelData[$(".panel-twx-sel-label").attr("panel-id")].css.top) + parseInt(panelData[$(".panel-twx-sel-label").attr("panel-id")].css.height) / 2;
                                $.each(ids, function (n, list) {
                                    list.css.top = (top - parseInt(list.css["height"]) / 2) + "px";
                                    $('div[panel-id="' + n + '"]').css("top", parseInt(list.css.top) + "px");
                                });
                                saveBool = true;
                            }
                            break;
                        //  水平、垂直居中
                        case "align-center-middle":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                left = parseInt(panelData[$(".panel-twx-sel-label").attr("panel-id")].css.left) + parseInt(panelData[$(".panel-twx-sel-label").attr("panel-id")].css.width) / 2;
                                top = parseInt(panelData[$(".panel-twx-sel-label").attr("panel-id")].css.top) + parseInt(panelData[$(".panel-twx-sel-label").attr("panel-id")].css.height) / 2;
                                $.each(ids, function (n, list) {
                                    list.css.left = (left - parseInt(list.css["width"]) / 2) + "px";
                                    list.css.top = (top - parseInt(list.css["height"]) / 2) + "px";
                                    $('div[panel-id="' + n + '"]').css({
                                        "left": parseInt(list.css.left) + "px",
                                        "top": parseInt(list.css.top) + "px"
                                    });
                                });
                                saveBool = true;
                            }
                            break;
                        //  宽度一致
                        case "width":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                width = panelData[$(".panel-twx-sel-label").attr("panel-id")].css.width;
                                $.each(ids, function (n, list) {
                                    list.css.width = width;
                                    $('div[panel-id="' + n + '"]').css("width", parseInt(list.css.width) + "px");
                                });
                                saveBool = true;
                            }
                            break;
                        //  高度一致
                        case "height":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                height = panelData[$(".panel-twx-sel-label").attr("panel-id")].css.height;
                                $.each(ids, function (n, list) {
                                    list.css.height = height;
                                    $('div[panel-id="' + n + '"]').css("height", parseInt(list.css.height) + "px");
                                });
                                saveBool = true;
                            }
                            break;
                        //  宽高一致
                        case "width-height":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                width = panelData[$(".panel-twx-sel-label").attr("panel-id")].css.width;
                                height = panelData[$(".panel-twx-sel-label").attr("panel-id")].css.height;
                                $.each(ids, function (n, list) {
                                    list.css.width = width;
                                    list.css.height = height;
                                    $('div[panel-id="' + n + '"]').css({
                                        "width": parseInt(list.css.width) + "px",
                                        "height": parseInt(list.css.height) + "px"
                                    });
                                });
                                saveBool = true;
                            }
                            break;
                        //  等水平间距
                        case "space-width":
                            if (!thiso.hasClass("twxui-tool-lock") && sel.length > 2) {
                                //  所选控件满足3个及以上
                                left = {}; width = 0;
                                $.each(ids, function (n, list) {
                                    left[n] = parseInt(list.css.left);
                                    width += parseInt(list.css.width);
                                });
                                var sort = Object.keys(left).sort(function (a, b) { return left[a] - left[b] });
                                var space = (left[sort[sel.length - 1]] - left[sort[0]] - width + parseInt(ids[sort[sel.length - 1]].css.width)) / (sort.length - 1);
                                for (var i = 1; i < sort.length - 1; i++) {
                                    panelData[sort[i]].css.left = parseInt(parseInt(ids[sort[i - 1]].css.left) + parseInt(ids[sort[i - 1]].css.width) + space) + "px";
                                    $('div[panel-id="' + sort[i] + '"]').css("left", parseInt(panelData[sort[i]].css.left) + "px");
                                }
                                saveBool = true;
                            }
                            break;
                        //  等垂直间距
                        case "space-height":
                            if (!thiso.hasClass("twxui-tool-lock") && sel.length > 2) {
                                //  所选控件满足3个及以上
                                top = {}; height = 0;
                                $.each(ids, function (n, list) {
                                    top[n] = parseInt(list.css.top);
                                    height += parseInt(list.css.height);
                                });
                                var sort = Object.keys(top).sort(function (a, b) { return top[a] - top[b] });
                                var space = (top[sort[sel.length - 1]] - top[sort[0]] - height + parseInt(ids[sort[sel.length - 1]].css.height)) / (sort.length - 1);
                                for (var i = 1; i < sort.length - 1; i++) {
                                    panelData[sort[i]].css.top = parseInt(parseInt(ids[sort[i - 1]].css.top) + parseInt(ids[sort[i - 1]].css.height) + space) + "px";
                                    $('div[panel-id="' + sort[i] + '"]').css("top", parseInt(panelData[sort[i]].css.top) + "px");
                                }
                                saveBool = true;
                            }
                            break;
                        //  组合
                        case "group":
                            if (!thiso.hasClass("twxui-tool-lock") && sel.length > 1) {
                                //  必须两个及以上控件组合
                                var id = new Date().getTime();
                                var newData = {
                                    "panel-type": "group",
                                    "css": {
                                        "top": "0",
                                        "left": "0",
                                        "width": "0",
                                        "height": "0",
                                        "cursor": "pointer"
                                    },
                                    "children": []
                                };
                                var newID = {
                                    "left": {}, "top": {}, "width": {}, "height": {}
                                };
                                $.each(ids, function (n, list) {
                                    newData.children.push(n);
                                    newID.left[parseInt(list.css["left"])] = n;
                                    newID.top[parseInt(list.css["top"])] = n;
                                    newID.width[parseInt(list.css["left"]) + parseInt(list.css["width"])] = n;
                                    newID.height[parseInt(list.css["top"]) + parseInt(list.css["height"])] = n;
                                });
                                var sort_left = Object.keys(newID.left).sort(function (a, b) { return a - b });
                                var sort_top = Object.keys(newID.top).sort(function (a, b) { return a - b });
                                var sort_width = Object.keys(newID.width).sort(function (a, b) { return a - b });
                                var sort_height = Object.keys(newID.height).sort(function (a, b) { return a - b });
                                newData.css.left = sort_left[0] + "px";
                                newData.css.top = sort_top[0] + "px";
                                newData.css.width = (sort_width[sort_width.length - 1] - sort_left[0]) + "px";
                                newData.css.height = (sort_height[sort_height.length - 1] - sort_top[0]) + "px";
                                //  清空所选框内的编辑框
                                $(".panel-twx-sel").find(".panel-twx-edit").remove();
                                $(".panel-twx-sel").removeClass("panel-twx-sel").removeClass("panel-twx-sel-label");
                                twxui_editor.getDrawPage("#panel-draw", newData, {
                                    "id": id, "left": sort_left[0], "top": sort_top[0]
                                }, true);
                                saveBool = true;
                            }
                            break;
                        //  解组
                        case "ungroup":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                var groupID = $(".panel-twx-sel").eq(0).attr("panel-id");
                                if (sel.length === 1 && panelData[groupID]["panel-type"] === "group") {
                                    $('div[panel-id="' + groupID + '"]').find(".panel-twx-edit").remove();
                                    $.each(panelData[groupID]["children"], function (k, v) {
                                        panelData[v].css.top = (parseFloat(panelData[v].css.top) + parseFloat(panelData[groupID].css.top)) + "px";
                                        panelData[v].css.left = (parseFloat(panelData[v].css.left) + parseFloat(panelData[groupID].css.left)) + "px";
                                        //  清除原标签
                                        $('div[panel-id="' + groupID + '"]').remove();

                                        //  组合内的数据
                                        twxui_editor.getDrawPage("#panel-draw", panelData[v], {
                                            "id": v,
                                            "left": parseFloat(panelData[v].css.left),
                                            "top": parseFloat(panelData[v].css.top)
                                        }, true);
                                    });
                                    delete panelData[groupID];
                                    //  清除原标签
                                    $('div[panel-id="' + groupID + '"]').remove();
                                    //  默认选中一个
                                    $(".panel-twx-sel").eq(0).addClass("panel-twx-sel-label");
                                    saveBool = true;
                                }
                            }
                            break;
                        //  锁定
                        case "lock":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                //  考虑组合的控件
                                groupFunc = function (obj) {
                                    $.each(obj, function (n, list) {
                                        list.lock = true;
                                        if (list["panel-type"] === "group") {
                                            var new_obj = {}, child_id = '';
                                            for (var i = 0; i < list["children"].length; i++) {
                                                child_id = list["children"][i];
                                                new_obj[child_id] = panelData[child_id];
                                            }
                                            groupFunc(new_obj);
                                        }
                                    });
                                }
                                groupFunc(ids);
                                saveBool = true;
                            }
                            break;
                        //  解锁
                        case "unlock":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                //  考虑组合的控件
                                groupFunc = function (obj) {
                                    $.each(obj, function (n, list) {
                                        list.lock = false;
                                        if (list["panel-type"] === "group") {
                                            var new_obj = {}, child_id = '';
                                            for (var i = 0; i < list["children"].length; i++) {
                                                child_id = list["children"][i];
                                                new_obj[child_id] = panelData[child_id];
                                            }
                                            groupFunc(new_obj);
                                        }
                                    });
                                }
                                groupFunc(ids);
                                saveBool = true;
                            }
                            break;
                        //  不可选：唯一选中时实现
                        case "unselect":
                            if (!thiso.hasClass("twxui-tool-lock") && sel.length === 1) {
                                $.each(ids, function (n, list) {
                                    list.select = true;
                                    list.css.cursor = "default";
                                    $('div[panel-id="' + n + '"]').removeClass("panel-twx-sel").find(".panel-twx-edit").remove();
                                    $('div[panel-id="' + n + '"]').css("cursor", list.css.cursor);
                                });
                                saveBool = true;
                            }
                            break;
                        //  多重复制
                        case "copy":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                saveBool = false;
                                var view = false;   //  预览
                                var copyID = [];
                                var copy_list = ["先行后列", "先列后行"];
                                //  考虑组合的控件
                                groupFunc = function (newID, data) {
                                    var newData = twx_prototype.deepClone(data);
                                    if (newData["panel-type"] === "group") {
                                        newData["children"] = [];
                                        var children = data["children"];
                                        for (var i = 0; i < children.length; i++) {
                                            newData["children"].push(newID + "-" + i);
                                            var childData = twx_prototype.deepClone(panelData[children[i]]);
                                            childData.css.top = (parseInt(childData.css.top) + parseInt(newData.css.top)) + "px";
                                            childData.css.left = (parseInt(childData.css.left) + parseInt(newData.css.left)) + "px";
                                            groupFunc(newID + "-" + i, childData);
                                        }
                                    }
                                    //  编辑框内：根据标签属性判断
                                    twxui_editor.getDrawPage("#panel-draw", newData, {
                                        "id": newID, "left": parseInt(newData.css.left), "top": parseInt(newData.css.top)
                                    }, false);
                                    copyID.push(newID);
                                    if (newData["panel-type"] === "group") {
                                        $('div[panel-id="' + newID + '"]').find(".panel-twx-edit").remove();
                                        $('div[panel-id="' + newID + '"]').removeClass("panel-twx-sel");
                                    }
                                }
                                //  布局
                                twx_popup.open({
                                    //  层标题；默认值：标题
                                    title: "多重复制"
                                    , rightCloseBtn: true
                                    //  *秒自动关闭层；默认值：5 秒
                                    , time: 0
                                    //  遮蔽罩；默认值：true（显示遮蔽罩，层其他位置不能点击）
                                    , shade: true
                                    //  按钮
                                    , btn: ["预览", "确认", "取消"]
                                    //  层区域大小
                                    , area: ["300px", "auto"]
                                    //  层内容
                                    , content: $('.copy-popup').html()
                                    , cancel: function (index, layero) {
                                        for (var i = 0; i < copyID.length; i++) {
                                            $('div[panel-id="' + copyID[i] + '"]').remove();
                                            delete panelData[copyID[i]];
                                        }
                                        twx_popup.close(index);
                                    }
                                    , func2: function (index, layero) {
                                        for (var i = 0; i < copyID.length; i++) {
                                            $('div[panel-id="' + copyID[i] + '"]').remove();
                                            delete panelData[copyID[i]];
                                        }
                                        twx_popup.close(index);
                                    }
                                    //  预览
                                    , func0: function (index, layero) {
                                        if (!view) {
                                            //  编辑框内：根据标签属性判断
                                            var id = $(".panel-twx-sel").attr("panel-id");
                                            //  排版数量
                                            var row = parseInt(layero.find('input[name="copy-row"]').val()),
                                                col = parseInt(layero.find('input[name="copy-col"]').val());
                                            //  行列间距
                                            var row_space = parseInt(layero.find('input[name="copy-rowspace"]').val()),
                                                col_space = parseInt(layero.find('input[name="copy-colspace"]').val());
                                            var childID = new Date().getTime();
                                            var number = 0;
                                            //  排版顺序
                                            switch (layero.find('.copy-list').attr("value")) {
                                                //  先行后列
                                                case "0":
                                                    for (var j = 0; j < row; j++) {
                                                        for (var i = 0; i < col; i++) {
                                                            number++;
                                                            if (!(j === 0 && i === 0)) {
                                                                groupFunc(childID + "" + number, panelData[id]);
                                                                panelData[childID + "" + number].css.left = (parseInt(panelData[id].css.left) + i * (parseInt(panelData[id].css.width) + row_space)) + "px";
                                                                panelData[childID + "" + number].css.top = (parseInt(panelData[id].css.top) + j * (parseInt(panelData[id].css.height) + col_space)) + "px";
                                                                $('div[panel-id="' + childID + "" + number + '"]').css(panelData[childID + "" + number].css);
                                                                $('div[panel-id="' + childID + "" + number + '"]').css({
                                                                    "left": (parseFloat(panelData[childID + "" + number].css.left)) + "px",
                                                                    "top": (parseFloat(panelData[childID + "" + number].css.top)) + "px",
                                                                    "width": (parseFloat(panelData[id].css.width)) + "px",
                                                                    "height": (parseFloat(panelData[id].css.height)) + "px"
                                                                });
                                                            }
                                                        }
                                                    }
                                                    break;
                                                //  先列后行
                                                case "1":
                                                    for (var j = 0; j < col; j++) {
                                                        for (var i = 0; i < row; i++) {
                                                            number++;
                                                            if (!(j === 0 && i === 0)) {
                                                                groupFunc(childID + "" + number, panelData[id]);
                                                                panelData[childID + "" + number].css.left = (parseInt(panelData[id].css.left) + j * (parseInt(panelData[id].css.width) + row_space)) + "px";
                                                                panelData[childID + "" + number].css.top = (parseInt(panelData[id].css.top) + i * (parseInt(panelData[id].css.height) + col_space)) + "px";
                                                                $('div[panel-id="' + childID + "" + number + '"]').css(panelData[childID + "" + number].css);
                                                                $('div[panel-id="' + childID + "" + number + '"]').css({
                                                                    "left": (parseFloat(panelData[childID + "" + number].css.left)) + "px",
                                                                    "top": (parseFloat(panelData[childID + "" + number].css.top)) + "px",
                                                                    "width": (parseFloat(panelData[id].css.width)) + "px",
                                                                    "height": (parseFloat(panelData[id].css.height)) + "px"
                                                                });
                                                            }
                                                        }
                                                    }
                                                    break;
                                                default: break;
                                            }
                                            $(".panel-twx-sel").removeClass("panel-twx-sel");
                                            $(".panel-twx-edit").remove();
                                            $('div[panel-id="' + id + '"]').addClass("panel-twx-sel");
                                            $('div[panel-id="' + id + '"]').append(twxEditor.panelEditor);
                                            view = true;
                                        } else {
                                            view = false;
                                            for (var i = 0; i < copyID.length; i++) {
                                                $('div[panel-id="' + copyID[i] + '"]').remove();
                                                delete panelData[copyID[i]];
                                            }
                                        }
                                    }
                                    //  确认
                                    , func1: function (index, layero) {
                                        if (view) {
                                            for (var i = 0; i < copyID.length; i++) {
                                                $('div[panel-id="' + copyID[i] + '"]').remove();
                                                delete panelData[copyID[i]];
                                            }
                                        }
                                        //  编辑框内：根据标签属性判断
                                        var id = $(".panel-twx-sel").attr("panel-id");
                                        //  排版数量
                                        var row = parseInt(layero.find('input[name="copy-row"]').val()),
                                            col = parseInt(layero.find('input[name="copy-col"]').val());
                                        //  行列间距
                                        var row_space = parseInt(layero.find('input[name="copy-rowspace"]').val()),
                                            col_space = parseInt(layero.find('input[name="copy-colspace"]').val());
                                        var childID = new Date().getTime();
                                        var number = 0;
                                        //  排版顺序
                                        switch (layero.find('.copy-list').attr("value")) {
                                            //  先行后列
                                            case "0":
                                                for (var j = 0; j < row; j++) {
                                                    for (var i = 0; i < col; i++) {
                                                        number++;
                                                        if (!(j === 0 && i === 0)) {
                                                            groupFunc(childID + "" + number, panelData[id]);
                                                            panelData[childID + "" + number].css.left = (parseInt(panelData[id].css.left) + i * (parseInt(panelData[id].css.width) + row_space)) + "px";
                                                            panelData[childID + "" + number].css.top = (parseInt(panelData[id].css.top) + j * (parseInt(panelData[id].css.height) + col_space)) + "px";
                                                            $('div[panel-id="' + childID + "" + number + '"]').css(panelData[childID + "" + number].css);
                                                            $('div[panel-id="' + childID + "" + number + '"]').css({
                                                                "left": (parseFloat(panelData[childID + "" + number].css.left)) + "px",
                                                                "top": (parseFloat(panelData[childID + "" + number].css.top)) + "px",
                                                                "width": (parseFloat(panelData[id].css.width)) + "px",
                                                                "height": (parseFloat(panelData[id].css.height)) + "px"
                                                            });
                                                        }
                                                    }
                                                }
                                                break;
                                            //  先列后行
                                            case "1":
                                                for (var j = 0; j < col; j++) {
                                                    for (var i = 0; i < row; i++) {
                                                        number++;
                                                        if (!(j === 0 && i === 0)) {
                                                            groupFunc(childID + "" + number, panelData[id]);
                                                            panelData[childID + "" + number].css.left = (parseInt(panelData[id].css.left) + j * (parseInt(panelData[id].css.width) + row_space)) + "px";
                                                            panelData[childID + "" + number].css.top = (parseInt(panelData[id].css.top) + i * (parseInt(panelData[id].css.height) + col_space)) + "px";
                                                            $('div[panel-id="' + childID + "" + number + '"]').css(panelData[childID + "" + number].css);
                                                            $('div[panel-id="' + childID + "" + number + '"]').css({
                                                                "left": (parseFloat(panelData[childID + "" + number].css.left)) + "px",
                                                                "top": (parseFloat(panelData[childID + "" + number].css.top)) + "px",
                                                                "width": (parseFloat(panelData[id].css.width)) + "px",
                                                                "height": (parseFloat(panelData[id].css.height)) + "px"
                                                            });
                                                        }
                                                    }
                                                }
                                                break;
                                            default: break;
                                        }
                                        $(".panel-twx-sel").removeClass("panel-twx-sel");
                                        $(".panel-twx-edit").remove();
                                        $('div[panel-id="' + id + '"]').addClass("panel-twx-sel");
                                        $('div[panel-id="' + id + '"]').append(twxEditor.panelEditor);
                                        twx_popup.close(index);
                                        //  记录面板当前的状态
                                        twxTool.savePre();
                                    }
                                });
                                //  默认值
                                $('input[name="copy-row"]').val('2');
                                $('input[name="copy-rowspace"]').val('10');
                                $('input[name="copy-col"]').val('2');
                                $('input[name="copy-colspace"]').val('10');
                                $(".copy-add").attr("value", "0");
                                $(".copy-add").removeClass("fa-square-o").removeClass("fa-check-square-o").addClass("fa-square-o");
                                $(".copy-list").attr("value", "0");
                                $(".copy-list").find("span").text(copy_list[0]);
                                $(".copy-list").find(".drop-down").text(copy_list[1]);
                                //  自动增加
                                $(".copy-add").off("click").on("click", function () {
                                    var copy_val = $(".copy-add").attr("value");
                                    switch (copy_val) {
                                        case "0":
                                            $(".copy-add").attr("value", "1");
                                            $(".copy-add").removeClass("fa-square-o").addClass("fa-check-square-o");
                                            break;
                                        case "1":
                                            $(".copy-add").attr("value", "0");
                                            $(".copy-add").removeClass("fa-check-square-o").addClass("fa-square-o");
                                            break;
                                        default:
                                            break;
                                    }
                                });
                                //  递增顺序
                                $(".copy-list").find(".drop-down").off("click").on("click", function () {
                                    var copy_val = $(".copy-list").attr("value");
                                    switch (copy_val) {
                                        case "0":
                                            $(".copy-list").attr("value", "1");
                                            $(".copy-list").find("span").text(copy_list[1]);
                                            $(".copy-list").find(".drop-down").text(copy_list[0]);
                                            break;
                                        case "1":
                                            $(".copy-list").attr("value", "0");
                                            $(".copy-list").find("span").text(copy_list[0]);
                                            $(".copy-list").find(".drop-down").text(copy_list[1]);
                                            break;
                                        default:
                                            break;
                                    }
                                });
                            }
                            break;
                        //  字体同步
                        case "font":
                            if (!thiso.hasClass("twxui-tool-lock") && sel.length > 0) {
                                var font = {};
                                var id = sel.length === 1 ? sel.attr("panel-id") : $(".panel-twx-sel-label").attr("panel-id");
                                twx_popup.open({
                                    //  层标题；默认值：标题
                                    title: "同步字体"
                                    //  右上关闭层按钮；默认值：true（显示关闭按钮）
                                    , rightCloseBtn: true
                                    //  *秒自动关闭层；默认值：5 秒
                                    , time: 0
                                    //  遮蔽罩；默认值：true（显示遮蔽罩，层其他位置不能点击）
                                    , shade: true
                                    //  是否点击遮罩关闭；默认值：false（点击不关闭当前层）
                                    , shadeClose: false
                                    //  按钮
                                    , btn: ["确认", "取消"]
                                    //  层区域大小
                                    , area: ["400px", "auto"]
                                    //  层内容
                                    , content: $("#view-attr-font").html()
                                    , func0: function (index, layero) {
                                        //  包含子级的选择内容
                                        var body = layero.find(".hover-body"), valArr = [];
                                        for (var i = 0; i < body.length; i++) {
                                            valArr = $(body[i]).find('input').attr("ul-li-type") !== "" ? $(body[i]).find('input').attr("ul-li-type").split(';') : [];
                                            switch ($(body[i]).attr("hover-type")) {
                                                case "font-align":
                                                    for (var j = 0; j < valArr.length; j++) {
                                                        font['flex'] === undefined ? font['flex'] = {} : "";
                                                        font['flex'][valArr[j].split(':')[0]] = valArr[j].split(':')[1];
                                                    }
                                                    break;
                                                case "font-style":
                                                    for (var j = 0; j < valArr.length; j++) {
                                                        font[valArr[j].split(':')[0]] = valArr[j].split(':')[1];
                                                    }
                                                    break;
                                                default:
                                                    break;
                                            }
                                        }
                                        //  考虑组合的控件
                                        groupFunc = function (obj) {
                                            $.each(obj, function (n, list) {
                                                if (list["panel-type"] === "group") {
                                                    var new_obj = {}, child_id = '';
                                                    for (var i = 0; i < list["children"].length; i++) {
                                                        child_id = list["children"][i];
                                                        new_obj[child_id] = panelData[child_id];
                                                    }
                                                    groupFunc(new_obj);
                                                }
                                                else {
                                                    //  同步字体属性
                                                    $.each(font, function (k, v) {
                                                        if (k === "flex") {
                                                            $('div[panel-id="' + n + '"]').find(".panel-twx-table").css(v);
                                                            panelData[n]["flex"] = v;
                                                            $('div[panel-id="' + n + '"]').find(".panel-twx-table").css(v);
                                                        } else {
                                                            panelData[n].css[k] = v;
                                                            $('div[panel-id="' + n + '"]').css(k, v);
                                                        }
                                                    });
                                                }
                                            });
                                        }
                                        groupFunc(ids);
                                        twx_popup.close(index);
                                        //  记录面板当前的状态
                                        twxTool.savePre();
                                    }
                                });
                                //  字体大小
                                $('input[name="font-size"]').on("input", function (e) {
                                    var val = (new RegExp("^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$")).test(e.delegateTarget.value) ? e.delegateTarget.value : 1.2;
                                    $(this).val(val);
                                    font["font-size"] = val + "rem";
                                });
                                //  下级菜单
                                rightMenu.menuChild();
                                //  颜色
                                $('.twxui-picker').on("mouseenter", function (e) {
                                    var e = e || window.event;
                                    var thiso = $(this);
                                    $("#twx-color").css({
                                        "left": e.clientX - e.offsetX + "px",
                                        "top": e.clientY - e.offsetY + "px",
                                        "width": thiso.width() + "px",
                                        "height": thiso.height() + "px"
                                    });
                                    var xnColor = new XNColorPicker({
                                        color: panelData[id].css[thiso.attr("css")] !== undefined ? panelData[id].css[thiso.attr("css")] : "",//"#f21fff",
                                        selector: "#twx-color",
                                        showprecolor: true,//显示预制颜色
                                        prevcolors: ["#ff0000", "#ffff00", "#00ff00", "#0000ff", "rgba(0,0,0,0)"],//预制颜色，不设置则默认
                                        showhistorycolor: false,//显示历史
                                        historycolornum: 16,//历史条数
                                        format: 'rgba',//rgba hex hsla,初始颜色类型
                                        showPalette: true,//显示色盘
                                        show: false, //初始化显示
                                        lang: 'cn',// cn 、en
                                        colorTypeOption: 'single',//
                                        onError: function (e) {
                                        },
                                        //  取消
                                        onCancel: function (color) {
                                            //  隐藏颜色标签
                                            $("#twx-color").css({
                                                "left": "0",
                                                "top": "0",
                                                "width": "0",
                                                "height": "0"
                                            });
                                        },
                                        onChange: function (color) {
                                            //console.log("change", color)
                                        },
                                        //  确认
                                        onConfirm: function (color) {
                                            //console.log("confirm", color)
                                            var res = color.color.rgbav[3] !== "1" ? color.color.rgba : color.color.hex;
                                            thiso.find('input').val(res);
                                            thiso.find('input').css("background-color", res);
                                            font_color = res;
                                            font["color"] = res;
                                            //  隐藏颜色标签
                                            $("#twx-color").css({
                                                "left": "0",
                                                "top": "0",
                                                "width": "0",
                                                "height": "0"
                                            });
                                        }
                                    });
                                });
                                //  隐藏颜色标签
                                $("#twx-color").on("mouseleave", function () {
                                    if ($(".fcolorpicker").length === 0) {
                                        //  隐藏颜色标签
                                        $("#twx-color").css({
                                            "left": "0",
                                            "top": "0",
                                            "width": "0",
                                            "height": "0"
                                        });
                                    }
                                });
                            }
                            break;
                        //  辅助提示
                        case "tips":
                            //  考虑组合的控件
                            if ($("#panel-draw").find(".panel-tips").length > 0) {
                                $("#panel-draw").find(".panel-tips").remove();
                            } else {
                                groupFunc = function (obj) {
                                    $.each(obj, function (n, list) {
                                        if (list["panel-type"] !== "group" && n !== "page-config") {
                                            $('div[panel-id="' + n + '"]').append('<div class="panel-tips" panel-tips="' + n + '">' + list["panel-type"] + "：" + n + '</div>');
                                        }
                                    });
                                };
                                groupFunc(panelData);
                            }
                            saveBool = true;
                            break;
                        //  全部可选：所有控件取消不可选
                        case "select":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                $.each(panelData, function (n, list) {
                                    if (list.select) {
                                        list.select = false;
                                        list.css.cursor = "pointer";
                                        $('div[panel-id="' + n + '"]').css("cursor", list.css.cursor);
                                    }
                                });
                                saveBool = true;
                            }
                            break;
                        //  安全检查【检测关联数据库的设备号和测点号】
                        case "check":
                            if (!thiso.hasClass("twxui-tool-lock")) {

                                saveBool = true;
                            }
                            break;
                        //  撤消
                        case "undo":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                twxTool.undoClick();
                                saveBool = false;
                            }
                            break;
                        //  恢复
                        case "reply":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                twxTool.recoveryClick();
                                saveBool = false;
                            }
                            break;
                        //  页面级别：权限使用
                        case "power":
                            if (!thiso.hasClass("twxui-tool-lock")) {

                            }
                            break;
                        //  可视化布局：phone、pad、pc
                        case "layout":
                            if (panelData["page-config"]["layout-page"] > 0) {
                                $(".auto-table").find('input[name="auto-layer-phone"]').val(panelData["page-config"]["layout-auto"].phone);
                                $(".auto-table").find('input[name="auto-layer-pad"]').val(panelData["page-config"]["layout-auto"].pad);
                                $(".auto-table").find('input[name="auto-layer-pc"]').val(panelData["page-config"]["layout-auto"].pc);
                                twx_popup.open({
                                    //  层标题；默认值：标题
                                    title: "可视化布局"
                                    //  右上关闭层按钮；默认值：true（显示关闭按钮）
                                    , rightCloseBtn: true
                                    //  *秒自动关闭层；默认值：5 秒
                                    , time: 0
                                    //  遮蔽罩；默认值：true（显示遮蔽罩，层其他位置不能点击）
                                    , shade: true
                                    //  是否点击遮罩关闭；默认值：false（点击不关闭当前层）
                                    , shadeClose: false
                                    //  按钮
                                    , btn: ["确认", "取消"]
                                    //  层区域大小
                                    , area: ["300px", "auto"]
                                    //  层内容
                                    , content: $(".auto-table").html()
                                    , func0: function (index, layero) {
                                        panelData["page-config"]["layout-auto"].phone = layero.find('input[name="auto-layer-phone"]').val().replace(/\s*$/g, "");
                                        panelData["page-config"]["layout-auto"].pad = layero.find('input[name="auto-layer-pad"]').val().replace(/\s*$/g, "");
                                        panelData["page-config"]["layout-auto"].pc = layero.find('input[name="auto-layer-pc"]').val().replace(/\s*$/g, "");
                                        twx_popup.close(index);
                                    }
                                });
                                $('input[name="auto-layer-phone"]').off("input").on("input", function (e) {
                                    var regExp = /^([1-9]|1[0-2])$/;
                                    var val = e.delegateTarget.value;
                                    var valArr = val.split(" ");
                                    for (var i = 0; i < valArr.length; i++) {
                                        if (!(i === valArr.length - 1 && valArr[i].replace(/\s+/g, "").length === 0)) {
                                            if (!regExp.test(valArr[i])) {
                                                valArr[i] = "1";
                                                $(this).val(valArr.join(' '));
                                            }
                                        }
                                    }
                                });
                                $('input[name="auto-layer-pad"]').off("input").on("input", function (e) {
                                    var regExp = /^([1-9]|1[0-2])$/;
                                    var val = e.delegateTarget.value;
                                    var valArr = val.split(" ");
                                    for (var i = 0; i < valArr.length; i++) {
                                        if (!(i === valArr.length - 1 && valArr[i].replace(/\s+/g, "").length === 0)) {
                                            if (!regExp.test(valArr[i])) {
                                                valArr[i] = "1";
                                                $(this).val(valArr.join(' '));
                                            }
                                        }
                                    }
                                });
                                $('input[name="auto-layer-pc"]').off("input").on("input", function (e) {
                                    var regExp = /^([1-9]|1[0-2])$/;
                                    var val = e.delegateTarget.value;
                                    var valArr = val.split(" ");
                                    for (var i = 0; i < valArr.length; i++) {
                                        if (!(i === valArr.length - 1 && valArr[i].replace(/\s+/g, "").length === 0)) {
                                            if (!regExp.test(valArr[i])) {
                                                valArr[i] = "1";
                                                $(this).val(valArr.join(' '));
                                            }
                                        }
                                    }
                                });
                            }
                            break;
                        //  多语言
                        case "language":
                            if (!thiso.hasClass("twxui-tool-lock")) {

                            }
                            break;
                        //  页面基础属性
                        case "cogs":
                            if (!thiso.hasClass("twxui-tool-lock")) {
                                var newId = new Date().getTime();
                                $("body").append('<div id="hide-' + newId + '" style="position:fixed;top:0;width:100%;height:100%;overflow: hidden;background-color: rgba(204,204,204,0.3);"></div>');
                                var winbox = new WinBox({
                                    title: "页面基础属性",
                                    x: "center",
                                    y: "center",
                                    width: "400px",
                                    height: "200px",
                                    onclose: function () {
                                        $("#hide-" + newId).remove();
                                    },
                                    html: '<div id="type-layout" style="height:100%;display:flex;flex-direction: column;color: #fff;background: #192c4f;"><div class="layer-body"><div>宽度：<input class="layer-input" type="text" name="name" value="" autocomplete="off" placeholder="单位：px、%"/></div><div>高度：<input class="layer-input" type="text" name="name" value="" autocomplete="off" placeholder="单位：px、%"/></div><div>自适应：<input class="layer-input" type="text" name="name" value="" autocomplete="off"/></div><div>行高：<input class="layer-input" type="text" name="name" value="" autocomplete="off" placeholder="单位：px、%"/></div></div><div class="layer-btn" style="color:#fab056;padding: 0.75rem 1.25rem;display:flex;"><span btn-type="sure">确定</span><span btn-type="cancel">取消</span></div></div>'
                                });
                                $(".layer-input").eq(0).focus();
                                $("#type-layout").find(".layer-btn").find("span").off("click").on("click", function () {
                                    var type = $(this).attr("btn-type");
                                    var input = $(".layer-input");
                                    var val, html;
                                    var row;
                                    switch (type) {
                                        case "sure":
                                            val = input.eq(0).val().split(' ');
                                            panelData.config.layout[newId] = {
                                                r: val
                                                , h: input.eq(1).val()
                                            };
                                            row = panelData.config.layout[newId];
                                            html = '<div class="row" style="height:' + row.h + ';">';
                                            for (var i = 0; i < row.r.length; i++) {
                                                html += '<div class="col-' + row.r[i] + ' twx-col"></div>';
                                            }
                                            html += '</div>';
                                            //html = '<div class="row" style="height:' + input.eq(1).val() + ';">';
                                            //for (var i = 0; i < val0.length; i++) {
                                            //    html += '<div class="col-' + val3[i] + ' col-md-' + val2[i] + ' col-xl-' + val0[i] + ' twx-col"></div>';
                                            //}
                                            //html += '</div>';
                                            $(".twx-container").append(html);
                                            winbox.close();
                                            break;
                                        default: break;
                                    }
                                });
                            }
                            break;
                        default:
                            break;
                    }
                    if (saveBool) {
                        //  记录面板当前的状态
                        twxTool.savePre();
                    }
                });
                twxTool.mousewheel();
                twxTool.keySelect();
                twxTool.menuNav();
            }
            //  工具可用状态
            , useable: function () {
                var tools = $(".twxui-tool");
                var sel = $(".panel-twx-sel");
                for (var i = 0; i < tools.length; i++) {
                    switch (tools.eq(i).attr("tool-type")) {
                        case "align-left":
                        case "align-right":
                        case "align-top":
                        case "align-bottom":
                        case "align-center":
                        case "align-middle":
                        case "align-center-middle":
                        case "width":
                        case "height":
                        case "width-height":
                        case "group":
                            if (sel.length > 1) {
                                tools.eq(i).removeClass("twxui-tool-lock");
                            } else {
                                tools.eq(i).removeClass("twxui-tool-lock").addClass("twxui-tool-lock");
                            }
                            break;
                        case "space-width":
                        case "space-height":
                            if (sel.length > 2) {
                                tools.eq(i).removeClass("twxui-tool-lock");
                            } else {
                                tools.eq(i).removeClass("twxui-tool-lock").addClass("twxui-tool-lock");
                            }
                            break;
                        case "copy":
                            if (sel.length === 1 && !panelData[sel.eq(0).attr("panel-id")]["lock"]) {
                                tools.eq(i).removeClass("twxui-tool-lock");
                            } else {
                                tools.eq(i).removeClass("twxui-tool-lock").addClass("twxui-tool-lock");
                            }
                            break;
                        case "ungroup":
                            if (sel.length === 1 && panelData[sel.eq(0).attr("panel-id")]["panel-type"] === "group" && !panelData[sel.eq(0).attr("panel-id")]["lock"]) {
                                tools.eq(i).removeClass("twxui-tool-lock");
                            } else {
                                tools.eq(i).removeClass("twxui-tool-lock").addClass("twxui-tool-lock");
                            }
                            break;
                        case "lock":
                            if (sel.length > 0) {
                                var bool = false;
                                for (var j = 0; j < sel.length; j++) {
                                    if (!panelData[sel.eq(j).attr("panel-id")].lock) {
                                        bool = true;
                                        break;
                                    }
                                }
                                bool ? tools.eq(i).removeClass("twxui-tool-lock") : tools.eq(i).removeClass("twxui-tool-lock").addClass("twxui-tool-lock");
                            } else {
                                tools.eq(i).removeClass("twxui-tool-lock").addClass("twxui-tool-lock");
                            }
                            break;
                        case "unlock":
                            if (sel.length > 0) {
                                var bool = false;
                                for (var j = 0; j < sel.length; j++) {
                                    if (panelData[sel.eq(j).attr("panel-id")].lock) {
                                        bool = true;
                                        break;
                                    }
                                }
                                bool ? tools.eq(i).removeClass("twxui-tool-lock") : tools.eq(i).removeClass("twxui-tool-lock").addClass("twxui-tool-lock");
                            } else {
                                tools.eq(i).removeClass("twxui-tool-lock").addClass("twxui-tool-lock");
                            }
                            break;
                        case "font":
                            if (sel.length > 0) {
                                tools.eq(i).removeClass("twxui-tool-lock");
                            } else {
                                tools.eq(i).removeClass("twxui-tool-lock").addClass("twxui-tool-lock");
                            }
                            break;
                        case "unselect":
                            if (sel.length === 1 && !panelData[sel.eq(0).attr("panel-id")]["select"]) {
                                tools.eq(i).removeClass("twxui-tool-lock");
                            } else {
                                tools.eq(i).removeClass("twxui-tool-lock").addClass("twxui-tool-lock");
                            }
                            break;
                        case "undo":
                            if (twxTool.resetCount < panelDataHistory.length - 1 && panelDataHistory.length !== 0) {
                                tools.eq(i).removeClass("twxui-tool-lock");
                            } else {
                                tools.eq(i).removeClass("twxui-tool-lock").addClass("twxui-tool-lock");
                            }
                            break;
                        case "reply":
                            if (twxTool.resetCount > 0 && panelDataHistory.length !== 0) {
                                tools.eq(i).removeClass("twxui-tool-lock");
                            } else {
                                tools.eq(i).removeClass("twxui-tool-lock").addClass("twxui-tool-lock");
                            }
                            break;
                        default:
                            break;
                    }
                }
            }
            //  绘图面板鼠标滚轮缩放
            , mousewheel: function () {
                // jquery 兼容的滚轮事件
                $(".panel-draw").on("mousewheel DOMMouseScroll", function (e) {
                    var delta = (e.originalEvent.wheelDelta && (e.originalEvent.wheelDelta > 0 ? 1 : -1)) ||  // chrome & ie
                        (e.originalEvent.detail && (e.originalEvent.detail > 0 ? -1 : 1));              // firefox
                    if (delta > 0) {
                        // 向上滚
                        panelData["page-config"].zoom = parseFloat(panelData["page-config"].zoom * 100 / 100 >= 5.0 ? 5.0 : (panelData["page-config"].zoom * 100 / 100 + 0.05)).toFixed(2);
                    }
                    else if (delta < 0) {
                        // 向下滚
                        panelData["page-config"].zoom = parseFloat((panelData["page-config"].zoom * 100 / 100 <= 0.2 ? 0.2 : panelData["page-config"].zoom * 100 / 100 - 0.05)).toFixed(2);
                    }
                    $.each(panelData, function (n, list) {
                        if (n !== "page-config") {
                            $('div[panel-id="' + n + '"]').css({
                                "left": parseFloat(list.css.left) + "px",
                                "top": parseFloat(list.css.top) + "px",
                                "width": parseFloat(list.css.width) + "px",
                                "height": parseFloat(list.css.height) + "px",
                                "font-size": (panelData[n].css["font-size"] !== undefined ? panelData[n].css["font-size"].replace("rem", '') : 1.2) + "rem"
                            });
                        }
                    });
                    $(".panel-zoom").text(Math.round(panelData["page-config"].zoom * 100) + " %");
                });
            }
            //  键盘事件：快捷按键
            , resetCount: 0     //  撤消、恢复使用的计数
            , keySelect: function () {
                $(document).keydown(function (e) {
                    //  判断 Ctrl+A(97),a(65) 事件是否发生
                    var e = e || window.event;
                    if ((e.ctrlKey || e.metaKey) && e.keyCode == 65) {
                        e.preventDefault();
                        $(".panel-twx-edit").remove();
                        $(".panel-twx-sel").removeClass("panel-twx-sel");
                        //  判断div的坐标
                        var groupArr = [];     //  选中区域内的控件
                        $.each(panelData, function (n, list) {
                            //  组合内的控件 不考虑在内
                            if (list["panel-type"] === "group") {
                                groupArr = groupArr.concat(list["children"]);
                            }
                        });
                        $.each(panelData, function (n, list) {
                            if (groupArr.indexOf(n) === -1 && n !== "page-config" && !list.select && !list.lock) {
                                $('div[panel-id="' + n + '"]').addClass("panel-twx-sel");
                                $('div[panel-id="' + n + '"]').append(twxEditor.panelEditor);
                            }
                        });
                        //  多控件，默认一个选中
                        if ($(".panel-twx-sel").length > 1) {
                            $(".panel-twx-sel").removeClass("panel-twx-sel-label");
                            $(".panel-twx-sel").eq(0).addClass("panel-twx-sel-label");
                        }
                        twxTool.useable();
                    }
                    //  撤消：Ctrl + Z、z
                    else if ((e.ctrlKey || e.metaKey) && e.keyCode == 90) {
                        twxTool.undoClick();
                    }
                    //  恢复：Ctrl + Y、y
                    else if ((e.ctrlKey || e.metaKey) && e.keyCode == 89) {
                        twxTool.recoveryClick();
                    }
                    //  保存：Ctrl + S、s
                    else if ((e.ctrlKey || e.metaKey) && e.keyCode == 83) {
                        e.preventDefault();
                        twxTool.saveClick();
                    }
                });
            }
            //  撤消：Ctrl + Z、z
            , undoClick: function () {
                twxTool.resetCount++;
                twxTool.resetCount = twxTool.resetCount >= panelDataHtml.length - 1 ? panelDataHtml.length - 1 : twxTool.resetCount;
                $("#panel-draw").html(panelDataHtml[panelDataHtml.length - 1 - twxTool.resetCount]);
                panelData = panelDataHistory[panelDataHtml.length - 1 - twxTool.resetCount];
                //  控件相关事件绑定
                //  是否选中控件标签，位置属性展示
                if ($("#panel-draw").find(".panel-twx-sel").length === 0) {
                    $(".panel-rect").hide();
                    $(".mouse-rect").show();
                }
                //  组合内的标签不做事件关联
                var groupArr = [];     //  选中区域内的控件
                $.each(panelDataHistory[panelDataHtml.length - 1 - twxTool.resetCount], function (n, list) {
                    //  组合内的控件 不考虑在内
                    if (list["panel-type"] === "group") {
                        groupArr = groupArr.concat(list["children"]);
                    }
                });
                $.each(panelDataHistory[panelDataHtml.length - 1 - twxTool.resetCount], function (n, list) {
                    if (groupArr.indexOf(n) === -1 && n !== "page-config") {
                        twx_drag.dragMonuse(n);
                    }
                });
                $(".panel-zoom").text(Math.round(panelDataHistory[panelDataHtml.length - 1 - twxTool.resetCount]["page-config"].zoom * 100) + " %");
                //  更新工具可使用状态
                twxTool.useable();
            }
            //  恢复：Ctrl + Y、y
            , recoveryClick: function () {
                twxTool.resetCount--;
                twxTool.resetCount = twxTool.resetCount <= 0 ? 0 : twxTool.resetCount;
                $("#panel-draw").html(panelDataHtml[panelDataHtml.length - 1 - twxTool.resetCount]);
                panelData = panelDataHistory[panelDataHtml.length - 1 - twxTool.resetCount];
                //  控件相关事件绑定
                //  是否选中控件标签，位置属性展示
                if ($("#panel-draw").find(".panel-twx-sel").length === 0) {
                    $(".panel-rect").hide();
                    $(".mouse-rect").show();
                }
                //  组合内的标签不做事件关联
                var groupArr = [];     //  选中区域内的控件
                $.each(panelDataHistory[panelDataHtml.length - 1 - twxTool.resetCount], function (n, list) {
                    //  组合内的控件 不考虑在内
                    if (list["panel-type"] === "group") {
                        groupArr = groupArr.concat(list["children"]);
                    }
                });
                $.each(panelDataHistory[panelDataHtml.length - 1 - twxTool.resetCount], function (n, list) {
                    if (groupArr.indexOf(n) === -1 && n !== "page-config") {
                        twx_drag.dragMonuse(n);
                    }
                });
                $(".panel-zoom").text(Math.round(panelDataHistory[panelDataHtml.length - 1 - twxTool.resetCount]["page-config"].zoom * 100) + " %");
                //  更新工具可使用状态
                twxTool.useable();
            }
            //  保存：Ctrl + S、s
            , saveClick: function () {
                //  组合内的标签不做事件关联
                var groupArr = [];     //  选中区域内的控件
                $.each(panelData, function (n, list) {
                    //  组合内的控件 不考虑在内
                    if (list["panel-type"] === "group") {
                        groupArr = groupArr.concat(list["children"]);
                    }
                });
                var left = [], top = [], width = [], height = [];
                $.each(panelData, function (n, list) {
                    if (groupArr.indexOf(n) === -1 && n !== "page-config") {
                        left[parseInt(list.css.left)] = n;
                        top[parseInt(list.css.top)] = n;
                        width[parseInt(list.css.width)] = n;
                        height[parseInt(list.css.height)] = n;
                    }
                });
                var sortL = Object.keys(left).sort(function (a, b) { return a - b; });
                var sortT = Object.keys(top).sort(function (a, b) { return a - b; });
                var sortW = Object.keys(width).sort(function (a, b) { return a - b; });
                var sortH = Object.keys(height).sort(function (a, b) { return a - b; });

                //  更新页面实际宽高
                panelData["page-config"].css = {
                    "left": sortL[0],
                    "top": sortT[0],
                    "width": sortW[sortW.length - 1],
                    "height": sortH[sortH.length - 1]
                };
            }
            //  记录面板之前的状态
            , savePre: function () {
                twxTool.resetCount = 0;
                panelDataHistory.push(twxAll.deepClone(panelData));
                panelDataHtml.push($("#panel-draw").html());
                if (panelDataHistory.length === 21) {
                    panelDataHistory.shift();
                    panelDataHtml.shift();
                }
                //  更新工具可使用状态
                twxTool.useable();

                //console.log(panelDataHistory);
            }
            //  导航栏菜单事件
            , menuNav: function () {
                var menus = $(".panel-menu");
                menus.off("click").on("click", function () {
                    var thiso = $(this);
                    var menu_type = thiso.attr("menu-type");
                    switch (menu_type) {
                        //  预览：当前面板
                        case "panel-view":
                            //$.each(panelData, function (n, list) {
                            //    if (n !== "page-config") {
                            //        twxui_panel.getDrawPage(n, list);
                            //    }
                            //});
                            twx_popup.open({
                                //  层标题；默认值：标题
                                title: false
                                //  *秒自动关闭层；默认值：5 秒
                                , time: 0
                                //  遮蔽罩；默认值：true（显示遮蔽罩，层其他位置不能点击）
                                , shade: true
                                //  按钮
                                , btn: ["取消"]
                                //  层区域大小
                                , area: ["100%", "100%"]
                                //  层内容
                                , content: $("#panel-draw").prop("outerHTML")
                                , func0: function (index, layero, value) {
                                    console.log(index);
                                    console.log(layero);
                                    console.log(value);
                                    twx_popup.close(index);
                                }
                            });
                            break;
                        //  下载：当前面板
                        case "panel-download":
                            twxTool.downloadFile(JSON.stringify(panelData), new Date().getTime() + '.json');
                            break;
                        //  视图：减 10%
                        case "panel-zoom-minus":
                            panelData["page-config"].zoom = parseFloat(panelData["page-config"].zoom * 100 / 100 - 0.05).toFixed(2);
                            $(".panel-zoom").text(Math.round(panelData["page-config"].zoom * 100) + " %");
                            $.each(panelData, function (n, list) {
                                if (n !== "page-config") {
                                    $('div[panel-id="' + n + '"]').css({
                                        "left": parseFloat(list.css.left) + "px",
                                        "top": parseFloat(list.css.top) + "px",
                                        "width": parseFloat(list.css.width) + "px",
                                        "height": parseFloat(list.css.height) + "px",
                                        "font-size": 1.2 + "rem"
                                    });
                                }
                            });
                            break;
                        //  视图：加 10%
                        case "panel-zoom-plus":
                            panelData["page-config"].zoom = parseFloat(panelData["page-config"].zoom * 100 / 100 + 0.05).toFixed(2);
                            $(".panel-zoom").text(Math.round(panelData["page-config"].zoom * 100) + " %");
                            $.each(panelData, function (n, list) {
                                if (n !== "page-config") {
                                    $('div[panel-id="' + n + '"]').css({
                                        "left": parseFloat(list.css.left) + "px",
                                        "top": parseFloat(list.css.top) + "px",
                                        "width": parseFloat(list.css.width) + "px",
                                        "height": parseFloat(list.css.height) + "px",
                                        "font-size": 1.2 + "rem"
                                    });
                                }
                            });
                            break;
                        //  视图：重置 100%
                        case "panel-zoom-reset":
                            panelData["page-config"].zoom = 1;
                            $(".panel-zoom").text("100 %");
                            $.each(panelData, function (n, list) {
                                if (n !== "page-config") {
                                    $('div[panel-id="' + n + '"]').css({
                                        "left": parseFloat(list.css.left) + "px",
                                        "top": parseFloat(list.css.top) + "px",
                                        "width": parseFloat(list.css.width) + "px",
                                        "height": parseFloat(list.css.height) + "px",
                                        "font-size": parseFloat(panelData[n].css["font-size"]) + "rem"
                                    });
                                }
                            });
                            break;
                        default:
                            break;
                    }
                });
            }
            //  保存并下载文件（txt 格式）
            , downloadFile: function (content, filename) {
                // 创建a标签
                var eleLink = document.createElement('a')
                // 设置a标签 download 属性，以及文件名
                eleLink.download = filename
                // a标签不显示
                eleLink.style.display = 'none'
                // 获取字符内容，转为blob地址
                var blob = new Blob([content])
                // blob地址转为URL
                eleLink.href = URL.createObjectURL(blob)
                // a标签添加到body
                document.body.appendChild(eleLink)
                // 触发a标签点击事件，触发下载
                eleLink.click()
                // a标签从body移除
                document.body.removeChild(eleLink)
            }
        };

        //  控件拖拽
        var twxDrag = {
            //  鼠标位置
            mouse_position: function () {
                //  未选中控件标签 - 鼠标移动位置
                $("#panel-draw").on("mousedown", function (ev) {
                    //  按下鼠标移动框
                    var e = ev || window.event;
                    e.preventDefault();
                    //  清空右键菜单展示
                    if (document.getElementById('right-menu') !== null) {
                        document.getElementById('right-menu').remove();
                    }
                    //  更新工具可使用状态
                    twxTool.useable();
                    //  是否选中控件标签，位置属性展示
                    $(document).off('mousemove');
                    $(".panel-rect").hide();
                    $(".mouse-rect").show();
                    $("#panel-draw").find(".panel-twx-sel").removeClass("panel-twx-sel").removeClass("panel-twx-sel-label");
                    $(".panel-twx-edit").remove();
                    // 鼠标点击其他位置时隐藏菜单
                    var right_menu = document.getElementById('right-menu');
                    right_menu !== null ? right_menu.remove() : false;
                    var left = e.clientX, top = e.clientY;
                    var id = new Date().getTime();
                    $("body").append('<div class="panel-group" id="' + id + '"></div>');
                    $("#" + id).css({
                        "position": "fixed",
                        "top": top,
                        "left": left,
                        "width": 0,
                        "height": 0,
                        "border": "1px dashed #1a96ff",
                        "z-index": "999999999999"
                    });
                    $(document).on("mousemove", function (ev) {
                        var e = ev || window.event;
                        e.preventDefault();
                        var height = e.clientY,
                            width = e.clientX;
                        var newTop = top + ((height - top) > 0 ? 0 : (height - top));
                        var newLeft = left + ((width - left) > 0 ? 0 : (width - left));
                        var newWidth = Math.abs(left - width);
                        var newHeight = Math.abs(top - height);
                        var realTop = newTop < 69 ? 70 : newTop;
                        var realLeft = newLeft < 200 ? 201 : newLeft;
                        var realWidth = width > 200 && width < $("#panel-draw").width() + 200 ? newWidth : (width <= 200 ? left - 201 : ((width > $("#panel-draw").width() + 200 ? $("#panel-draw").width() + 200 - left : 0)));
                        var realHeight = height > 69 && height < $("#panel-draw").height() + 69 ? newHeight : (height <= 69 ? top - 70 : ((height > $("#panel-draw").height() + 69 ? $("#panel-draw").height() + 69 - top : 0)));
                        $("#" + id).css({
                            "top": realTop + "px",
                            "left": realLeft + "px",
                            "width": realWidth + "px",
                            "height": realHeight + "px"
                        });
                        //  清空选中的标签
                        $(".panel-twx-edit").remove();
                        $(".panel-twx-sel").removeClass("panel-twx-sel").removeClass("panel-twx-sel-label");
                        //  判断div的坐标
                        var idArr = {}, groupArr = [];     //  选中区域内的控件
                        $.each(panelData, function (n, list) {
                            //  组合内的控件 不考虑在内
                            if (list["panel-type"] === "group") {
                                groupArr = groupArr.concat(list["children"]);
                            }
                        });
                        $.each(panelData, function (n, list) {
                            if (groupArr.indexOf(n) === -1 && n !== "page-config") {
                                var bool = twxDrag.isOverlap({
                                    "top": realTop - 69,
                                    "left": realLeft - 200,
                                    "width": realWidth,
                                    "height": realHeight
                                }, {
                                        "top": parseInt(list.css.top),
                                        "left": parseInt(list.css.left),
                                        "width": parseInt(list.css.width),
                                        "height": parseInt(list.css.height)
                                    });
                                //  排除不可选控件 select:true
                                if (bool && !panelData[n]["select"]) {
                                    idArr[n] = parseInt(list.css["left"]);
                                    $('div[panel-id="' + n + '"]').addClass("panel-twx-sel");
                                    $('div[panel-id="' + n + '"]').append(twxEditor.panelEditor);
                                }
                            }
                        });
                        //  多选控件
                        if ($(".panel-twx-sel").length > 1) {
                            var sort = Object.keys(idArr).sort(function (a, b) { return idArr[a] - idArr[b] });
                            //  多选控件默认选中的为 left 最大值
                            $('div[panel-id="' + sort[sort.length - 1] + '"]').removeClass("panel-twx-sel-label").addClass("panel-twx-sel-label");
                        }
                    }).on("mouseup", function () {
                        //  更新工具可使用状态
                        twxTool.useable();
                        $("#" + id).remove();
                        $(document).off("mousemove");
                        $(document).off("mouseup");
                    });
                }).on("mousemove", function (ev) {
                    if ($("#panel-draw").find(".panel-twx-sel").length === 0) {
                        var e = ev || window.event;
                        $('input[name="rect-x"]').val(e.pageX - 200);
                        $('input[name="rect-y"]').val(e.pageY - 40 - 29);
                    }
                    else {
                        //  控件标签位置属性
                        var id = $("#panel-draw").find(".panel-twx-sel").eq(0).attr("panel-id");
                        $('input[name="rect-w"]').val(parseInt(panelData[id].css.width));
                        $('input[name="rect-h"]').val(parseInt(panelData[id].css.height));
                    }
                });
                //  鼠标展示框监控输入
                $(".panel-rect").find('input[name="rect-x"]').on("input", function (e) {
                    var id = $(document.querySelector(".panel-twx-sel")).attr('panel-id');
                    panelData[id].css.left = parseInt('0' + e.delegateTarget.value) + 'px';
                    $(document.querySelector(".panel-twx-sel")).css({
                        'left': panelData[id].css.left
                    });
                });
                $(".panel-rect").find('input[name="rect-y"]').on("input", function (e) {
                    var id = $(document.querySelector(".panel-twx-sel")).attr('panel-id');
                    panelData[id].css.top = parseInt('0' + e.delegateTarget.value) + 'px';
                    $(document.querySelector(".panel-twx-sel")).css({
                        'top': panelData[id].css.top
                    });
                });
                $(".panel-rect").find('input[name="rect-w"]').on("input", function (e) {
                    var id = $(document.querySelector(".panel-twx-sel")).attr('panel-id');
                    panelData[id].css.width = parseInt('0' + e.delegateTarget.value) + 'px';
                    $(document.querySelector(".panel-twx-sel")).css({
                        'width': panelData[id].css.width
                    });
                });
                $(".panel-rect").find('input[name="rect-h"]').on("input", function (e) {
                    var id = $(document.querySelector(".panel-twx-sel")).attr('panel-id');
                    panelData[id].css.height = parseInt('0' + e.delegateTarget.value) + 'px';
                    $(document.querySelector(".panel-twx-sel")).css({
                        'height': panelData[id].css.height
                    });
                });
            }
            //  断两个div的位置是否相交
            , isOverlap: function (objOne, objTwo) {
                var x1 = objOne.left;
                var y1 = objOne.top;
                var x2 = x1 + objOne.width;
                var y2 = y1 + objOne.height;

                var x3 = objTwo.left;
                var y3 = objTwo.top;
                var x4 = x3 + objTwo.width;
                var y4 = y3 + objTwo.height;

                var zx = Math.abs(x1 + x2 - x3 - x4);
                var x = Math.abs(x1 - x2) + Math.abs(x3 - x4);
                var zy = Math.abs(y1 + y2 - y3 - y4);
                var y = Math.abs(y1 - y2) + Math.abs(y3 - y4);
                return (zx <= x && zy <= y);
            }
            //  鼠标相对拖动标签【id】内宽高
            , dragMonuse: function (id) {
                twxDrag.dragResize(id);
                //  锁定控件不操作
                if (!panelData[id].lock) {
                    twxDrag.dragChange(id);
                }
                //  右键菜单
                rightMenu.init(id);
            }
            //  标签拖动
            , dragResize: function (id) {
                var div = $('.panel-twx[panel-id="' + id + '"]');
                //  标签拖拽
                div.on("mousedown", function (ev) {
                    var e = ev || window.ev;
                    console.log(e);
                    var thiso = $(this);
                    //  控件标签位置属性
                    var id = thiso.attr("panel-id");
                    //  排除不可选控件 select:true
                    //if (!panelData[id]["select"]) {
                    e.stopPropagation();
                    //  多控件选择
                    $(".panel-twx-sel").removeClass("panel-twx-sel-label");
                    //  锁定控件不操作
                    //if (!panelData[id].lock) {
                    //  按下鼠标记录鼠标按下的初始状态位置
                    var position = {
                        'w': thiso[0].clientWidth,  //  宽度
                        'h': thiso[0].clientHeight, //  高度
                        'x': e.clientX,     //  记录鼠标点下的位置
                        'y': e.clientY,     //  记录鼠标点下的位置
                        'left': parseInt(panelData[id].css.left),      //  拖拽标签的 定位左偏移
                        'top': parseInt(panelData[id].css.top),      //  拖拽标签的 定位高度
                        'parentW': thiso[0].parentElement.clientWidth,  //  限定区域内的宽度
                        'parentH': thiso[0].parentElement.clientHeight, //  限定区域内的高度
                        'offX': e.offsetX,
                        'offY': e.offsetY
                    };
                    $(document).on("mousemove", function (event) {
                        div.removeClass("panel-twx-sel").addClass("panel-twx-sel");
                        //  点击进行移动
                        var e = event || window.event;
                        //  活动范围
                        //if (e.clientX >= $("#panel-draw")[0].offsetLeft + e.offsetX &&
                        //    e.clientX <= $("#panel-draw")[0].offsetLeft + e.offsetX - e.target.offsetWidth + $("#panel-draw").width() &&
                        //    e.clientY >= $("#panel-draw")[0].offsetTop + e.offsetY &&
                        //    e.clientY <= $("#panel-draw")[0].offsetTop + e.offsetY - e.target.offsetHeight + $("#panel-draw").height()) {

                        var left = e.clientX - position.x + position.left;
                        var top = e.clientY - position.y + position.top;
                        //  标签位置属性信息：所有所选控件
                        var idTemp = "";
                        for (var i = 0; i < $(".panel-twx-sel").length; i++) {
                            idTemp = $(".panel-twx-sel").eq(i).attr("panel-id");
                            //  拖动的标签
                            $(".panel-twx-sel").eq(i).css({
                                'left': parseFloat(e.clientX - position.x + parseInt(panelData[idTemp].css.left)).toFixed(3) + 'px',
                                'top': parseFloat(e.clientY - position.y + parseInt(panelData[idTemp].css.top)).toFixed(3) + 'px'
                            });
                        }
                        //}
                    }).on("mouseup", function () {
                        $(document).off('mousemove');
                        $(document).off('mouseup');
                        var idTemp = "";
                        var moveBool = false;
                        var left, top;
                        for (var i = 0; i < $(".panel-twx-sel").length; i++) {
                            idTemp = $(".panel-twx-sel").eq(i).attr("panel-id");
                            left = parseFloat(parseFloat($(".panel-twx-sel").eq(i).css("left"))).toFixed(3) + "px";
                            top = parseFloat(parseFloat($(".panel-twx-sel").eq(i).css("top"))).toFixed(3) + "px";

                            //  拖动的标签
                            if (parseInt(left) !== parseInt(panelData[idTemp].css.left)) {
                                moveBool = true;
                                panelData[idTemp].css.left = left;
                            }
                            if (parseInt(top) !== parseInt(panelData[idTemp].css.top)) {
                                moveBool = true;
                                panelData[idTemp].css.top = top;
                            }
                        }
                        //  更新工具可使用状态
                        twxTool.useable();
                        //  记录面板当前的状态
                        moveBool ? twxTool.savePre() : "";
                    });
                    //  拖拽缩放
                    twxDrag.dragChange(id);
                    //}
                    //  更新工具可使用状态
                    twxTool.useable();
                    //}
                });
            }
            //  标签缩放
            , dragChange: function (id) {
                var div = $('div[panel-id="' + id + '"]');
                //  左上
                var divChild_lt = div.find(".left-top");
                divChild_lt.on("mousedown", function (event) {
                    var e = event || window.event;
                    e.stopPropagation();    //  静止冒泡事件
                    var parent = $(this).parents(".panel-twx-sel");
                    //  多选控件中被选中样式
                    if ($(".panel-twx-sel").length > 1) {
                        $(".panel-twx-sel").removeClass("panel-twx-sel-label");
                        parent.removeClass("panel-twx-sel-label").addClass("panel-twx-sel-label");
                    }
                    //  按下鼠标记录鼠标按下的初始状态位置
                    var position = {
                        'w': parent[0].clientWidth,  //  宽度
                        'h': parent[0].clientHeight, //  高度
                        'x': e.clientX,     //  记录鼠标点下的位置
                        'y': e.clientY,     //  记录鼠标点下的位置
                        'left': parent[0].offsetLeft,      //  拖拽标签的 定位左偏移
                        'top': parent[0].offsetTop,      //  拖拽标签的 定位高度
                        'parentW': parent[0].parentElement.clientWidth,  //  限定区域内的宽度
                        'parentH': parent[0].parentElement.clientHeight, //  限定区域内的高度
                    };
                    $(document).on("mousemove", function (event) {
                        //  点击进行缩放
                        var e = event || window.event;
                        //  设置拖动不能出父级范围
                        var width = -(e.clientX - position.x) + position.w;
                        if (width < 4) {
                            width = 4;
                        } else if (width > (position.left + position.w)) {
                            width = position.left + position.w;
                        }
                        var height = -(e.clientY - position.y) + position.h;
                        if (height < 4) {
                            height = 4;
                        } else if (height > (position.top + position.h)) {
                            height = position.top + position.h;
                        }

                        var left = e.clientX - position.x + position.left;
                        if (left < 0) {
                            left = 0;
                        } else if ((left + 4) > (position.left + position.w)) {
                            left = position.left + position.w - 4;
                        }
                        var top = e.clientY - position.y + position.top;
                        if (top < 0) {
                            top = 0;
                        } else if ((top + 4) > (position.top + position.h)) {
                            top = position.top + position.h - 4;
                        }
                        //  标签位置属性信息
                        panelData[id].css.top = top / panelData["page-config"].zoom + 'px';
                        panelData[id].css.left = left / panelData["page-config"].zoom + 'px';
                        panelData[id].css.width = width / panelData["page-config"].zoom + 'px';
                        panelData[id].css.height = height / panelData["page-config"].zoom + 'px';
                        //  拖动的标签
                        div.css({
                            'top': top + "px",
                            'left': left + "px",
                            'width': width + "px",
                            'height': height + "px"
                        });
                        $('input[name="rect-x"]').val(parseInt(panelData[id].css.left));
                        $('input[name="rect-y"]').val(parseInt(panelData[id].css.top));
                        $('input[name="rect-w"]').val(parseInt(panelData[id].css.width));
                        $('input[name="rect-h"]').val(parseInt(panelData[id].css.height));
                    }).on("mouseup", function () {
                        $(document).off("mousemove");
                    });
                }).on("mouseup", function () {
                    $(document).off("mousemove");
                });
                //  右上
                var divChild_rt = div.find(".right-top");
                divChild_rt.on("mousedown", function (event) {
                    var e = event || window.event;
                    e.stopPropagation();    //  静止冒泡事件
                    var parent = $(this).parents(".panel-twx-sel");
                    //  多选控件中被选中样式
                    if ($(".panel-twx-sel").length > 1) {
                        $(".panel-twx-sel").removeClass("panel-twx-sel-label");
                        parent.removeClass("panel-twx-sel-label").addClass("panel-twx-sel-label");
                    }
                    //  按下鼠标记录鼠标按下的初始状态位置
                    var position = {
                        'w': parent[0].clientWidth,  //  宽度
                        'h': parent[0].clientHeight, //  高度
                        'x': e.clientX,     //  记录鼠标点下的位置
                        'y': e.clientY,     //  记录鼠标点下的位置
                        'left': parent[0].offsetLeft,      //  拖拽标签的 定位左偏移
                        'top': parent[0].offsetTop,      //  拖拽标签的 定位高度
                        'parentW': parent[0].parentElement.clientWidth,  //  限定区域内的宽度
                        'parentH': parent[0].parentElement.clientHeight, //  限定区域内的高度
                    };
                    $(document).on("mousemove", function (event) {
                        //  点击进行缩放
                        var e = event || window.event;
                        //  设置拖动不能出父级范围
                        var width = e.clientX - position.x + position.w;
                        if (width < 4) {
                            width = 4;
                        } else if ((width + position.left) > position.parentW) {
                            width = position.parentW - position.left;
                        }
                        var height = -(e.clientY - position.y) + position.h;
                        if (height < 4) {
                            height = 4;
                        } else if (height > (position.top + position.h)) {
                            height = position.top + position.h;
                        }

                        var top = e.clientY - position.y + position.top;
                        if (top < 0) {
                            top = 0;
                        } else if ((top + 4) > (position.top + position.h)) {
                            top = position.top + position.h - 4;
                        }
                        //  标签位置属性信息
                        panelData[id].css.top = top / panelData["page-config"].zoom + 'px';
                        panelData[id].css.width = width / panelData["page-config"].zoom + 'px';
                        panelData[id].css.height = height / panelData["page-config"].zoom + 'px';
                        //  拖动的标签
                        div.css({
                            'top': top + "px",
                            'width': width + "px",
                            'height': height + "px"
                        });
                        $('input[name="rect-y"]').val(parseInt(panelData[id].css.top));
                        $('input[name="rect-w"]').val(parseInt(panelData[id].css.width));
                        $('input[name="rect-h"]').val(parseInt(panelData[id].css.height));
                    }).on("mouseup", function () {
                        $(document).off("mousemove");
                    });
                }).on("mouseup", function () {
                    $(document).off("mousemove");
                });
                //  左下
                var divChild_lb = div.find(".left-bottom");
                divChild_lb.on("mousedown", function (event) {
                    var e = event || window.event;
                    e.stopPropagation();    //  静止冒泡事件
                    var parent = $(this).parents(".panel-twx-sel");
                    //  多选控件中被选中样式
                    if ($(".panel-twx-sel").length > 1) {
                        $(".panel-twx-sel").removeClass("panel-twx-sel-label");
                        parent.removeClass("panel-twx-sel-label").addClass("panel-twx-sel-label");
                    }
                    //  按下鼠标记录鼠标按下的初始状态位置
                    var position = {
                        'w': parent[0].clientWidth,  //  宽度
                        'h': parent[0].clientHeight, //  高度
                        'x': e.clientX,     //  记录鼠标点下的位置
                        'y': e.clientY,     //  记录鼠标点下的位置
                        'left': parent[0].offsetLeft,      //  拖拽标签的 定位左偏移
                        'top': parent[0].offsetTop,      //  拖拽标签的 定位高度
                        'parentW': parent[0].parentElement.clientWidth,  //  限定区域内的宽度
                        'parentH': parent[0].parentElement.clientHeight, //  限定区域内的高度
                    };
                    $(document).on("mousemove", function (event) {
                        //  点击进行缩放
                        var e = event || window.event;
                        //  设置拖动不能出父级范围
                        var width = -(e.clientX - position.x) + position.w;
                        if (width < 4) {
                            width = 4;
                        } else if (width > (position.left + position.w)) {
                            width = position.left + position.w;
                        }
                        var height = e.clientY - position.y + position.h;
                        if (height < 4) {
                            height = 4;
                        } else if ((height + position.top) > position.parentH) {
                            height = position.parentH - position.top;
                        }

                        var left = e.clientX - position.x + position.left;
                        if (left < 0) {
                            left = 0;
                        } else if ((left + 4) > (position.left + position.w)) {
                            left = position.left + position.w - 4;
                        }
                        //  标签位置属性信息
                        panelData[id].css.left = left / panelData["page-config"].zoom + 'px';
                        panelData[id].css.width = width / panelData["page-config"].zoom + 'px';
                        panelData[id].css.height = height / panelData["page-config"].zoom + 'px';
                        //  拖动的标签
                        div.css({
                            'left': left + "px",
                            'width': width + "px",
                            'height': height + "px"
                        });
                        $('input[name="rect-x"]').val(parseInt(panelData[id].css.left));
                        $('input[name="rect-w"]').val(parseInt(panelData[id].css.width));
                        $('input[name="rect-h"]').val(parseInt(panelData[id].css.height));
                    }).on("mouseup", function () {
                        $(document).off("mousemove");
                    });
                }).on("mouseup", function () {
                    $(document).off("mousemove");
                });
                //  右下
                var divChild_rb = div.find(".right-bottom");
                divChild_rb.on("mousedown", function (event) {
                    var e = event || window.event;
                    e.stopPropagation();    //  静止冒泡事件
                    var parent = $(this).parents(".panel-twx-sel");
                    //  多选控件中被选中样式
                    if ($(".panel-twx-sel").length > 1) {
                        $(".panel-twx-sel").removeClass("panel-twx-sel-label");
                        parent.removeClass("panel-twx-sel-label").addClass("panel-twx-sel-label");
                    }
                    //  按下鼠标记录鼠标按下的初始状态位置
                    var position = {
                        'w': parent[0].clientWidth,  //  宽度
                        'h': parent[0].clientHeight, //  高度
                        'x': e.clientX,     //  记录鼠标点下的位置
                        'y': e.clientY,     //  记录鼠标点下的位置
                        'left': parent[0].offsetLeft,      //  拖拽标签的 定位左偏移
                        'top': parent[0].offsetTop,      //  拖拽标签的 定位高度
                        'parentW': parent[0].parentElement.clientWidth,  //  限定区域内的宽度
                        'parentH': parent[0].parentElement.clientHeight, //  限定区域内的高度
                    };
                    $(document).on("mousemove", function (event) {
                        //  点击进行缩放
                        var e = event || window.event;
                        //  设置拖动不能出父级范围
                        var width = e.clientX - position.x + position.w;
                        if (width < 4) {
                            width = 4;
                        } else if ((width + position.left) > position.parentW) {
                            width = position.parentW - position.left;
                        }
                        var height = e.clientY - position.y + position.h;
                        if (height < 4) {
                            height = 4;
                        } else if ((height + position.top) > position.parentH) {
                            height = position.parentH - position.top;
                        }
                        //  标签位置属性信息
                        panelData[id].css.width = width / panelData["page-config"].zoom + 'px';
                        panelData[id].css.height = height / panelData["page-config"].zoom + 'px';
                        //  拖动的标签
                        div.css({
                            'width': width + "px",
                            'height': height + "px"
                        });
                        $('input[name="rect-w"]').val(parseInt(panelData[id].css.width));
                        $('input[name="rect-h"]').val(parseInt(panelData[id].css.height));
                    }).on("mouseup", function () {
                        $(document).off("mousemove");
                    });;
                }).on("mouseup", function () {
                    $(document).off("mousemove");
                });
                //  旋转
                var divChild_ct = div.find(".center-top");
                divChild_ct.on("mousedown", function (event) {
                    var e = event || window.event;
                    e.stopPropagation();    //  静止冒泡事件
                    var parent = $(this).parents(".panel-twx-sel");
                    //  多选控件中被选中样式
                    if ($(".panel-twx-sel").length > 1) {
                        $(".panel-twx-sel").removeClass("panel-twx-sel-label");
                        parent.removeClass("panel-twx-sel-label").addClass("panel-twx-sel-label");
                    }
                    //  按下鼠标记录鼠标按下的初始状态位置
                    var position = {
                        'w': parent[0].clientWidth,  //  宽度
                        'h': parent[0].clientHeight, //  高度
                        'x': e.clientX,     //  记录鼠标点下的位置
                        'y': e.clientY,     //  记录鼠标点下的位置
                        'left': parent[0].offsetLeft,      //  拖拽标签的 定位左偏移
                        'top': parent[0].offsetTop,      //  拖拽标签的 定位高度
                        'parentW': parent[0].parentElement.clientWidth,  //  限定区域内的宽度
                        'parentH': parent[0].parentElement.clientHeight, //  限定区域内的高度
                    };
                    var arrowX = position.left + position.w / 2 + 200;
                    var arrowY = position.top + position.h / 2 + 70;
                    $(document).on("mousemove", function (event) {
                        //  点击进行缩放
                        var e = event || window.event;
                        //  标签位置属性信息
                        var angle = 'rotate(' + parseInt(Math.atan2(e.clientY - arrowY, e.clientX - arrowX) / Math.PI * 180 + 90) + 'deg)';
                        panelData[id].css["transform"] = angle;
                        panelData[id].css["-ms-transform"] = angle;
                        panelData[id].css["-moz-transform"] = angle;
                        panelData[id].css["-webkit-transform"] = angle;
                        panelData[id].css["-o-transform"] = angle;
                        //  拖动的标签
                        div.css({
                            "transform": angle,
                            "-ms-transform": angle,
                            "-moz-transform": angle,
                            "-webkit-transform": angle,
                            "-o-transform": angle
                        });
                    }).on("mouseup", function () {
                        $(document).off('mousemove');
                    });
                }).on("mouseup", function () {
                    $(document).off("mousemove");
                });;
            }
        };

        //  右键菜单
        var rightMenu = {
            init: function (id) {
                $('div[panel-id="' + id + '"]').on("contextmenu", function (e) {
                    var e = e || window.event;
                    e.preventDefault(); //阻止系统右键菜单 IE8-不支持
                    if (!panelData[id].lock && !panelData[id].select) {
                        var right_menu = document.getElementById('right-menu');
                        right_menu !== null ? right_menu.remove() : null;
                        $("body").append(rightMenu.rightLabel);
                        var menu = document.getElementById('right-menu');
                        //  自定义 id元素的鼠标事件处理函数
                        menu.style.left = ((e.clientX < $("body").width() - 200) ? e.clientX : $("body").width() - 201) + 'px';
                        menu.style.top = ((e.clientY < $("body").height() - 290 - 30) ? e.clientY : $("body").height() - 290 - 30) + 'px';
                        //  执行菜单事件
                        //  标签复制
                        $(menu).find("#menu-copy").off("click").on('click', function () {
                            rightMenu.menuCopy(id);
                        });
                        //  标签粘贴
                        $(menu).find("#menu-paste").off("click").on('click', function () {
                            rightMenu.menuPaste(id);
                        });
                        //  标签删除
                        $(menu).find("#menu-del").off("click").on('click', function () {
                            rightMenu.menuDel(id);
                        });
                        //  移至最前
                        $(menu).find("#menu-top").off("click").on('click', function () {
                            rightMenu.menuTop(id);
                        });
                        //  移至前一级
                        $(menu).find("#menu-pre").off("click").on('click', function () {
                            rightMenu.menuPre(id);
                        });
                        //  移至后一级
                        $(menu).find("#menu-next").off("click").on('click', function () {
                            rightMenu.menuNext(id);
                        });
                        //  移至最后
                        $(menu).find("#menu-last").off("click").on('click', function () {
                            rightMenu.menuLast(id);
                        });
                        //  属性
                        $(menu).find("#menu-field").off("click").on('click', function () {
                            rightMenu.menuField(id);
                        });
                    }
                });
            },
            //  属性框事件
            field: function () {
                //  当前所选 id
                var id = $(".panel-twx-sel-label").length === 0 ? $(".panel-twx-sel").eq(0).attr("panel-id") : $(".panel-twx-sel-label").attr("panel-id");
                //  动态配置
                switch (panelData[id]["panel-type"]) {
                    case "group":
                    case "wenshidu":
                    case "wenshidu2":
                    case "wenshidu2-1":
                    case "wenshidu3":
                    case "bar1":
                    case "menulist":
                    case "devicelist":
                    case "spotlist":
                    case "event":
                    case "battery":
                    case "hisdata":
                    case "input":
                    case "txt":
                        //  标签属性：数据关联 选中
                        var field_type = $(".twx-content").find(".child-type-list .div-td");
                        field_type.on("click", function () {
                            var obj = $(this);
                            var io = obj.find("i");
                            var bool_open = false;
                            if (io.hasClass("fa-square-o")) {
                                bool_open = true;
                                obj.find(".fa").removeClass("fa-square-o").addClass("fa-check-square-o");
                            } else {
                                bool_open = false;
                                obj.find(".fa").removeClass("fa-check-square-o").addClass("fa-square-o");
                            }
                            switch (obj.attr("panel-type")) {
                                case "panel-text":
                                    bool_open ? $(".twx-content").find('.panel-field-title span[panel-type="panel-text"]').removeClass("open").addClass("open") : $(".twx-content").find('.panel-field-title span[panel-type="panel-text"]').removeClass("open");
                                    break;
                                case "panel-font":
                                    bool_open ? $(".twx-content").find('.panel-field-title span[panel-type="panel-font"]').removeClass("open").addClass("open") : $(".twx-content").find('.panel-field-title span[panel-type="panel-font"]').removeClass("open");
                                    break;
                                case "panel-background":
                                    bool_open ? $(".twx-content").find('.panel-field-title span[panel-type="panel-background"]').removeClass("open").addClass("open") : $(".twx-content").find('.panel-field-title span[panel-type="panel-background"]').removeClass("open");
                                    break;
                                case "panel-image":
                                    bool_open ? $(".twx-content").find('.panel-field-title span[panel-type="panel-image"]').removeClass("open").addClass("open") : $(".twx-content").find('.panel-field-title span[panel-type="panel-image"]').removeClass("open");
                                    break;
                                case "panel-animation":
                                    bool_open ? $(".twx-content").find('.panel-field-title span[panel-type="panel-animation"]').removeClass("open").addClass("open") : $(".twx-content").find('.panel-field-title span[panel-type="panel-animation"]').removeClass("open");
                                    break;
                                case "panel-event":
                                    bool_open ? $(".twx-content").find('.panel-field-title span[panel-type="panel-event"]').removeClass("open").addClass("open") : $(".twx-content").find('.panel-field-title span[panel-type="panel-event"]').removeClass("open");
                                    break;
                                default:
                                    break;
                            }
                        });
                        //  判断是否选中
                        for (var i = 0; i < field_type.length; i++) {
                            switch ($(field_type[i]).attr("panel-type")) {
                                //  事件
                                case "panel-event":
                                    if (Object.keys(panelData[id].event).length > 0) {
                                        $(field_type[i]).find(".fa").removeClass("fa-check-square-o").removeClass("fa-square-o").addClass("fa-check-square-o");
                                        $(".twx-content").find('.panel-field-title span[panel-type="panel-event"]').removeClass("open").addClass("open");
                                        //  事件绑定内容
                                    }
                                    break;
                                default:
                                    break;
                            }
                        }

                        //  标签属性：数据关联 展示
                        var field_type_title = $(".twx-content").find(".panel-field-title span");
                        field_type_title.on("click", function () {
                            var obj = $(this);
                            field_type_title.removeClass("active");
                            obj.addClass("active");
                            //  对应的类型属性隐藏与展示
                            $(".panel-field-info").removeClass("open");
                            switch (obj.attr("panel-type")) {
                                case "panel-common":
                                    $(".twx-content").find('.panel-field-info[panel-type="panel-common"]').addClass("open");
                                    break;
                                case "panel-text":
                                    $(".twx-content").find('.panel-field-info[panel-type="panel-text"]').addClass("open");
                                    break;
                                case "panel-font":
                                    $(".twx-content").find('.panel-field-info[panel-type="panel-font"]').addClass("open");
                                    break;
                                case "panel-background":
                                    $(".twx-content").find('.panel-field-info[panel-type="panel-background"]').addClass("open");
                                    break;
                                case "panel-image":
                                    $(".twx-content").find('.panel-field-info[panel-type="panel-image"]').addClass("open");
                                    break;
                                case "panel-animation":
                                    $(".twx-content").find('.panel-field-info[panel-type="panel-animation"]').addClass("open");
                                    break;
                                case "panel-event":
                                    $(".twx-content").find('.panel-field-info[panel-type="panel-event"]').addClass("open");
                                    break;
                                default:
                                    break;
                            }
                        });

                        //  颜色：背景色
                        $('.twxui-picker[css="background-color"]').find("input").css("background-color", "inherit");
                        if (panelData[id].css["background-color"] !== undefined) {
                            $('.twxui-picker[css="background-color"]').find("input").css("background-color", panelData[id].css["background-color"]);
                            $('.twxui-picker[css="background-color"]').find("input").val(panelData[id].css["background-color"]);
                        }
                        //  颜色：字体
                        $('.twxui-picker[css="color"]').find("input").css("background-color", "inherit");
                        if (panelData[id].css["color"] !== undefined) {
                            $('.twxui-picker[css="color"]').find("input").css("background-color", panelData[id].css["color"]);
                            $('.twxui-picker[css="color"]').find("input").val(panelData[id].css["color"]);
                        }
                        //  颜色
                        $('.twxui-picker').on("mouseenter", function (e) {
                            var e = e || window.event;
                            var thiso = $(this);
                            $("#twx-color").css({
                                "left": e.clientX - e.offsetX + "px",
                                "top": e.clientY - e.offsetY + "px",
                                "width": thiso.width() + "px",
                                "height": thiso.height() + "px"
                            });
                            var xnColor = new XNColorPicker({
                                color: panelData[id].css[thiso.attr("css")] !== undefined ? panelData[id].css[thiso.attr("css")] : "",//"#f21fff",
                                selector: "#twx-color",
                                showprecolor: true,//显示预制颜色
                                prevcolors: ["#ff0000", "#ffff00", "#00ff00", "#0000ff", "rgba(0,0,0,0)"],//预制颜色，不设置则默认
                                showhistorycolor: false,//显示历史
                                historycolornum: 16,//历史条数
                                format: 'rgba',//rgba hex hsla,初始颜色类型
                                showPalette: true,//显示色盘
                                show: false, //初始化显示
                                lang: 'cn',// cn 、en
                                colorTypeOption: 'single',//
                                onError: function (e) {
                                },
                                //  取消
                                onCancel: function (color) {
                                    //  隐藏颜色标签
                                    $("#twx-color").css({
                                        "left": "0",
                                        "top": "0",
                                        "width": "0",
                                        "height": "0"
                                    });
                                },
                                onChange: function (color) {
                                    //console.log("change", color)
                                },
                                //  确认
                                onConfirm: function (color) {
                                    //console.log("confirm", color)
                                    var res = color.color.rgbav[3] !== "1" ? color.color.rgba : color.color.hex;
                                    thiso.find('input').val(res);
                                    thiso.find('input').css("background-color", res);
                                    panelData[id].css[thiso.attr("css")] = res;
                                    $('div[panel-id="' + id + '"]').css(thiso.attr("css"), res);
                                    switch (thiso.attr("css")) {
                                        case "background-color":
                                            panelData[id].css["background"] = panelData[id].css["background"] !== undefined ? panelData[id].css["background"].split("no-repeat")[0] + "no-repeat " + res : "none";
                                            break;
                                        default:
                                            break;
                                    }
                                    //  隐藏颜色标签
                                    $("#twx-color").css({
                                        "left": "0",
                                        "top": "0",
                                        "width": "0",
                                        "height": "0"
                                    });
                                }
                            });
                        });
                        //  隐藏颜色标签
                        $("#twx-color").on("mouseleave", function () {
                            if ($(".fcolorpicker").length === 0) {
                                //  隐藏颜色标签
                                $("#twx-color").css({
                                    "left": "0",
                                    "top": "0",
                                    "width": "0",
                                    "height": "0"
                                });
                            }
                        });

                        //  背景图
                        $('input[name="background"]').css("background", panelData[id].css["background"] !== undefined ? panelData[id].css["background"].split("no-repeat")[0].replace("100%", "auto") + "no-repeat" : "none");
                        $('input[name="background"]').on("click", function (e) {
                            //  弹出文件框
                            twx_popup.open({
                                //  层标题；默认值：标题
                                title: "图库"
                                //  右上关闭层按钮；默认值：true（显示关闭按钮）
                                , rightCloseBtn: true
                                //  *秒自动关闭层；默认值：5 秒
                                , time: 0
                                //  遮蔽罩；默认值：true（显示遮蔽罩，层其他位置不能点击）
                                , shade: true
                                //  按钮
                                , btn: ["确认", "取消"]
                                //  层区域大小
                                , area: ["600px", "500px"]
                                //  层内容
                                , content: $('.img-gallery-parent').html()
                                //  右侧点击回调
                                , func0: function (index, layero) {
                                    var src = 'url(' + $(".img-info").find(".active").find("img").attr("src") + ') center center / 100% 100% no-repeat';
                                    panelData[id].css["background"] = src + (panelData[id].css["background-color"] !== undefined ? ' ' + panelData[id].css["background-color"] : "");
                                    $('input[name="background"]').css("background", src.replace("100%", "auto"));
                                    $('div[panel-id="' + id + '"]').css("background", panelData[id].css["background"]);
                                    twx_popup.close(index);
                                }
                            });
                            //  图库列表
                            //$.fn.zTree.init($(".treeDemo"), setting, zNodes);
                            $(".img-info-img").on("click", function () {
                                var thiso = $(this);
                                $(".img-info-img").removeClass("active");
                                thiso.addClass("active");
                            });
                        });

                        //  列表框：对齐、字形
                        $(".drop-ul-li").off("click").on("click", function () {
                            var thiso = $(this);
                            var input = thiso.parents(".drop-parent").find(".drop-input");
                            var value = thiso.attr("ul-li-type");
                            input.val(thiso.text());
                            input.attr("ul-li-type", value);
                            var valArr = value.split(';');
                            switch (input.attr('name')) {
                                //  父级样式
                                case "css":
                                    for (var i = 0; i < valArr.length; i++) {
                                        panelData[id].css[valArr[i].split(':')[0]] = valArr[i].split(':')[1];
                                        $('div[panel-id="' + id + '"]').css(valArr[i].split(':')[0], valArr[i].split(':')[1]);
                                    }
                                    break;
                                //  子级样式
                                case "flex":
                                    for (var i = 0; i < valArr.length; i++) {
                                        panelData[id].flex[valArr[i].split(':')[0]] = valArr[i].split(':')[1];
                                        $('div[panel-id="' + id + '"]').find('.panel-twx-table').css(valArr[i].split(':')[0], valArr[i].split(':')[1]);
                                    }
                                    break;
                                default:
                                    break;
                            }
                        });

                        //  旋转角度：0-360 transform: rotate(60deg);
                        $('input[name="rotate"]').val(panelData[id].css.transform !== undefined ? panelData[id].css.transform.replace('rotate(', '').replace('deg)', '') : "");
                        $('input[name="rotate"]').on("input", function (e) {
                            var val = (new RegExp("^([1-9]|([1-9][0-9])|([1-2][0-9][0-9])|([3][0-5][0-9])|([0]{1}))$|^[3][6][0]$")).test(e.delegateTarget.value) ? e.delegateTarget.value : 0;
                            $(this).val(val);
                            var angle = 'rotate(' + val + 'deg)';
                            panelData[id].css["transform"] = angle;
                            panelData[id].css["-ms-transform"] = angle;
                            panelData[id].css["-moz-transform"] = angle;
                            panelData[id].css["-webkit-transform"] = angle;
                            panelData[id].css["-o-transform"] = angle;

                            $('div[panel-id="' + id + '"]').css({
                                "transform": angle,
                                "-ms-transform": angle,
                                "-moz-transform": angle,
                                "-webkit-transform": angle,
                                "-o-transform": angle
                            });
                        });

                        //  权限：0-20
                        $('input[name="power"]').val(panelData[id].power !== undefined ? panelData[id].power : "");
                        $('input[name="power"]').on("input", function (e) {
                            var val = (new RegExp("^([0-9]|([1][0-9])|20)$")).test(e.delegateTarget.value) ? e.delegateTarget.value : 0;
                            $(this).val(val);
                            panelData[id].power = val;
                        });

                        //  文本 字体大小 name="font-size"
                        $('input[name="font-size"]').val(panelData[id].css["font-size"] !== undefined ? panelData[id].css["font-size"].replace('rem', "") : "");
                        $('input[name="font-size"]').on("input", function (e) {
                            var val = (new RegExp("^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$")).test(e.delegateTarget.value) ? e.delegateTarget.value : 1.2;
                            $(this).val(val);
                            panelData[id].css["font-size"] = val + "rem";
                            $('div[panel-id="' + id + '"]').css("font-size", val + "rem");
                        });

                        //  文本显示内容name="text"
                        $('input[name="text"]').val(panelData[id].text !== undefined ? panelData[id].text : "");
                        $('input[name="text"]').on("input", function (e) {
                            var val = e.delegateTarget.value;
                            $(this).text(val);
                            panelData[id].text = val;
                            $('div[panel-id="' + id + '"]').find(".panel-twx-table").text(val);
                        });
                        //  文本设备绑定
                        $('.device-binding').on("click", function (e) {
                            var thiso = $(this);
                            var input = thiso.parents(".child").find("input");
                            //  zTree 数据
                            var treeObj;
                            //  弹出文件框
                            twx_popup.open({
                                //  层标题；默认值：标题
                                title: panelData[id]["panel-type"] === "menulist" ? "菜单列表" : "工程设备列表"
                                //  右上关闭层按钮；默认值：true（显示关闭按钮）
                                , rightCloseBtn: true
                                //  *秒自动关闭层；默认值：5 秒
                                , time: 0
                                //  遮蔽罩；默认值：true（显示遮蔽罩，层其他位置不能点击）
                                , shade: true
                                //  按钮
                                , btn: ["确认", "取消"]
                                //  层区域大小
                                , area: ["300px", "400px"]
                                //  层内容
                                , content: panelData[id]["panel-type"] === "menulist" ? $('.menu-list').html() : $('.device-list').html()
                                //  右侧点击回调
                                , func0: function (index, layero) {
                                    var nodes = treeObj.getCheckedNodes(true);
                                    var name = [], nos = [];
                                    switch (panelData[id]["panel-type"]) {
                                        case "menulist":
                                            panelData[id]["echarts"]["menulist"] = [];
                                            $.each(nodes, function (n, list) {
                                                panelData[id]["echarts"]["menulist"].push({
                                                    "id": list.id,
                                                    "pid": list.pId,
                                                    "name": list.name,
                                                    "icon": list.icons,
                                                    "liClass": list.liClass,
                                                    "class": list.class,
                                                    "href": list.href,
                                                    "panel": list.panel
                                                });
                                            });
                                            break;
                                        case "devicelist":
                                            panelData[id]["echarts"]["devicelist"] = [];
                                            $.each(nodes, function (n, list) {
                                                panelData[id]["echarts"]["devicelist"].push({
                                                    "id": list.id,
                                                    "pid": "00",
                                                    "name": list.name,
                                                    "class": "",
                                                    "href": ""
                                                });
                                            });
                                            break;
                                        case "spotlist":
                                            panelData[id]["echarts"]["spotlist"] = [];
                                            $.each(nodes, function (n, list) {
                                                panelData[id]["echarts"]["spotlist"].push({
                                                    "id": list.id,
                                                    "pid": "00",
                                                    "name": list.name,
                                                    "alarm": "正常",
                                                    "href": ""
                                                });
                                            });
                                            break;
                                        case "battery":
                                            panelData[id]["echarts"]["battery"] = [];
                                            $.each(nodes, function (n, list) {
                                                panelData[id]["echarts"]["battery"].push({
                                                    "id": list.id,
                                                    "pid": "00",
                                                    "title": "正常",
                                                    "name": list.name,
                                                    "src": "../../image/svg/pie.svg"
                                                });
                                            });
                                            break;
                                        case "hisdata":
                                            panelData[id]["echarts"]["hisdata"] = [];
                                            $.each(nodes, function (n, list) {
                                                panelData[id]["echarts"]["hisdata"].push({
                                                    "id": list.id,
                                                    "pId": list.pId,
                                                    "name": list.name
                                                });
                                            });
                                            break;
                                        default:
                                            $.each(nodes, function (n, list) {
                                                name.push(list.name);
                                                nos.push(list.id);
                                            });
                                            input.val(name.join(','));
                                            panelData[id]["deviceNo"] = nos.join(',');
                                            panelData[id]["deviceNm"] = name.join(',');
                                            $('div[panel-id="' + id + '"]').find(".panel-twx-table").text(name[0]);
                                            panelData[id].text = name[0];
                                            break;
                                    }
                                    twx_popup.close(index);
                                }
                            });
                            switch (panelData[id]["panel-type"]) {
                                case "menulist":
                                    //  菜单列表
                                    treeObj = $.fn.zTree.init($(".treeMenu"), settingMenu, JSON.parse(sessionStorage.getItem("DataMenu")));
                                    break;
                                default:
                                    //  工程设备列表
                                    treeObj = $.fn.zTree.init($(".treeDevice"), settingDevice, JSON.parse(sessionStorage.getItem("DataEquip")));
                                    break;
                            }
                        });

                        //  动态配置
                        //  字体：先默认输出
                        $('input[name="device-spot-font"]').on("click", function () {
                            //  弹出文件框
                            //twx_popup.open({
                            //    //  层标题；默认值：标题
                            //    title: "工程设备列表"
                            //    //  右上关闭层按钮；默认值：true（显示关闭按钮）
                            //    , rightCloseBtn: true
                            //    //  *秒自动关闭层；默认值：5 秒
                            //    , time: 0
                            //    //  遮蔽罩；默认值：true（显示遮蔽罩，层其他位置不能点击）
                            //    , shade: true
                            //    //  按钮
                            //    , btn: ["确认", "取消"]
                            //    //  层区域大小
                            //    , area: ["300px", "400px"]
                            //    //  层内容
                            //    , content: $('.device-list').html()
                            //    //  右侧点击回调
                            //    , func0: function (index, layero) {
                            //        //var node = treeObj.getSelectedNodes()[0];
                            //        //panelData[id].text = node.name;
                            //        //panelData[id]["device"] = node.id;
                            //        //$('input[name="text"]').val(panelData[id].text);
                            //        //$('div[panel-id="' + id + '"]').find(".panel-twx-table").text(panelData[id].text);
                            //        twx_popup.close(index);
                            //        ////  字体  设备测点字典关联 E:1,A:1-1,D:1-1
                            //        //$('input[name="device-spot-font"]').val(panelData[id].text);
                            //        ////  背景
                            //        //$('input[name="device-spot-bk"]').val(panelData[id].text);
                            //        ////  图片
                            //        //$('input[name="device-spot-img"]').val(panelData[id].text);
                            //        ////  动画
                            //        //$('input[name="device-spot-move"]').val(panelData[id].text);
                            //    }
                            //});
                            ////  工程设备列表
                            //var treeObj = $.fn.zTree.init($(".treeDevice"), setting, zNodesDevice);
                        });

                        //  事件
                        $(".panel-event").on("click", function () {
                            var thiso = $(this);
                            var type = thiso.attr("event-type");    //  事件类型
                            switch (type) {
                                //  设备控制
                                case "control":
                                    break;
                                //  超链接
                                case "http":
                                    break;
                                //  动画
                                case "animation":
                                    twx_popup.open({
                                        //  层标题；默认值：标题
                                        title: "动画"
                                        //  右上关闭层按钮；默认值：true（显示关闭按钮）
                                        , rightCloseBtn: true
                                        //  *秒自动关闭层；默认值：5 秒
                                        , time: 0
                                        //  遮蔽罩；默认值：true（显示遮蔽罩，层其他位置不能点击）
                                        , shade: true
                                        //  按钮
                                        , btn: ["预览", "确认", "取消"]
                                        //  层区域大小
                                        , area: ["400px", "auto"]
                                        //  层内容
                                        , content: $("#panel-event").html()
                                        //  右侧点击回调
                                        , cancel: function (index, layero) {
                                            twx_popup.close(index);
                                            $(".event-animation").attr("class-type", "").val("");
                                        }
                                        , func0: function (index, layero) {
                                            $('div[panel-id="' + id + '"]').removeClass($(".event-animation").attr("class-type")).addClass($(".event-animation").attr("class-type"));
                                        }
                                        , func1: function (index, layero) {
                                            twx_popup.close(index);
                                            panelData[id].event["animation"] = $(".event-animation").attr("class-type");
                                        }, func2: function (index, layero) {
                                            twx_popup.close(index);
                                            $(".event-animation").attr("class-type", "").val("");
                                        }
                                    });
                                    rightMenu.menuChild();
                                    break;
                                //  设备屏蔽
                                case "shield":
                                    break;
                                //  复合命令
                                case "all-event":
                                    break;
                                default:
                                    break;
                            }
                        });
                        break;
                    case "line":
                        //  标签属性：曲线最值（最大值、最小值、平均值）
                        var field_type = $(".twx-content").find(".check-box .box-td");
                        field_type.on("click", function () {
                            var obj = $(this);
                            var io = obj.find("i");
                            if (io.hasClass("fa-square-o")) {
                                obj.find(".fa").removeClass("fa-square-o").addClass("fa-check-square-o");
                            } else {
                                obj.find(".fa").removeClass("fa-check-square-o").addClass("fa-square-o");
                            }
                            var val = [], type = [];
                            for (var i = 0; i < field_type.length; i++) {
                                if ($(field_type[i]).find(".fa-check-square-o").length > 0) {
                                    type.push($(field_type[i]).attr("panel-type"));
                                    val.push($(field_type[i]).find('span').text());
                                }
                            }
                            obj.parents(".drop-parent").find('input').val(val.join(','));
                            obj.parents(".drop-parent").find('input').attr("panel-type", type.join(','));
                            delete panelData[id].echarts["line"]["series"][0]["markPoint"];
                            delete panelData[id].echarts["line"]["series"][0]["markLine"];
                            panelData[id].echarts["line"]["grid"]["right"] = "10";

                            for (var j = 0; j < panelData[id].echarts["line"]["series"].length; j++) {
                                for (var i = 0; i < type.length; i++) {
                                    switch (type[i]) {
                                        case "max":
                                            if (panelData[id].echarts["line"]["series"][j]["markPoint"] === undefined) {
                                                panelData[id].echarts["line"]["series"][j]["markPoint"] = { data: [] };
                                            }
                                            panelData[id].echarts["line"]["series"][j]["markPoint"]["data"].push({ type: 'max', name: '最大值' });
                                            break;
                                        case "min":
                                            if (panelData[id].echarts["line"]["series"][j]["markPoint"] === undefined) {
                                                panelData[id].echarts["line"]["series"][j]["markPoint"] = { data: [] };
                                            }
                                            panelData[id].echarts["line"]["series"][j]["markPoint"]["data"].push({ type: 'min', name: '最小值' });
                                            break;
                                        case "average":
                                            panelData[id].echarts["line"]["series"][j]["markLine"] = {
                                                data: [
                                                    { type: 'average', name: '平均值' }
                                                ]
                                            };
                                            panelData[id].echarts["line"]["grid"]["right"] = "50";
                                            break;
                                        default: break;
                                    }
                                }
                            };
                        });
                        //  颜色：背景色
                        $('.twx-lay .twxui-picker[css="background-color"]').find("input").css("background-color", "inherit");
                        if (panelData[id].css["background-color"] !== undefined) {
                            $('.twx-lay .twxui-picker[css="background-color"]').find("input").css("background-color", panelData[id].css["background-color"]);
                            $('.twx-lay .twxui-picker[css="background-color"]').find("input").val(panelData[id].css["background-color"]);
                        }
                        //  颜色 colors\visualMap\itemStyle\areaStyle
                        var colors = [], visualMap = [], itemStyle = [], areaStyle = [];//  是否添加下一组
                        $(".twxui-picker-add").on("click", function () {
                            itemStyle = [];
                            areaStyle = [];
                            $('.twx-lay .twxui-picker[css="itemStyle"]').append('<div class="div-array"></div>');
                            $('.twx-lay .twxui-picker[css="areaStyle"]').append('<div class="div-array"></div>');
                            $('.twx-lay .twxui-picker[css="itemStyle"]').find(".div-array").length > panelData[id].echarts["line"]["series"].length ? panelData[id].echarts["line"]["series"].push(twx_prototype.deepClone(panelData[id].echarts["line"]["series"][0])) : "";
                        });
                        $(".twxui-picker-del").on("click", function () {
                            var thiso = $(this);
                            var div_array = thiso.parents(".child").find(".twxui-picker");
                            var num = 0;
                            var len = panelData[id].echarts["line"]["series"].length;
                            switch (thiso.attr("css")) {
                                case "colors":
                                    colors.pop();
                                    div_array.find("span").eq(div_array.find("span").length - 1).remove();
                                    break;
                                case "visualMap":
                                    visualMap.pop();
                                    div_array.find("span").eq(div_array.find("span").length - 1).remove();
                                    break;
                                case "itemStyle":
                                    itemStyle = [];
                                    div_array.find(".div-array").eq(div_array.find(".div-array").length - 1).remove();
                                    num = $('.twx-lay .twxui-picker[css="itemStyle"]').find(".div-array").length > $('.twx-lay .twxui-picker[css="areaStyle"]').find(".div-array").length ? $('.twx-lay .twxui-picker[css="itemStyle"]').find(".div-array").length : $('.twx-lay .twxui-picker[css="areaStyle"]').find(".div-array").length;
                                    if (num < len && num !== 0) {
                                        panelData[id].echarts["line"]["series"].pop();
                                    }
                                    break;
                                case "areaStyle":
                                    areaStyle = [];
                                    div_array.find(".div-array").eq(div_array.find(".div-array").length - 1).remove();
                                    num = $('.twx-lay .twxui-picker[css="itemStyle"]').find(".div-array").length > $('.twx-lay .twxui-picker[css="areaStyle"]').find(".div-array").length ? $('.twx-lay .twxui-picker[css="itemStyle"]').find(".div-array").length : $('.twx-lay .twxui-picker[css="areaStyle"]').find(".div-array").length;
                                    if (num < len && num !== 0) {
                                        panelData[id].echarts["line"]["series"].pop();
                                    }
                                    break;
                                default:
                                    break;
                            }
                        });
                        $('.twx-lay .twxui-picker').on("mouseenter", function (e) {
                            var e = e || window.event;
                            var thiso = $(this);
                            $("#twx-color").css({
                                "left": e.clientX - e.offsetX + "px",
                                "top": e.clientY - e.offsetY + "px",
                                "width": thiso.width() + "px",
                                "height": thiso.height() + "px"
                            });
                            var xnColor = new XNColorPicker({
                                color: panelData[id].css[thiso.attr("css")] !== undefined ? panelData[id].css[thiso.attr("css")] : "",//"#f21fff",
                                selector: "#twx-color",
                                showprecolor: true,//显示预制颜色
                                prevcolors: ["#ff0000", "#ffff00", "#00ff00", "#0000ff", "rgba(0,0,0,0)"],//预制颜色，不设置则默认
                                showhistorycolor: false,//显示历史
                                historycolornum: 16,//历史条数
                                format: 'rgba',//rgba hex hsla,初始颜色类型
                                showPalette: true,//显示色盘
                                show: false, //初始化显示
                                lang: 'cn',// cn 、en
                                colorTypeOption: 'single',//
                                onError: function (e) {
                                },
                                //  取消
                                onCancel: function (color) {
                                    //  隐藏颜色标签
                                    $("#twx-color").css({
                                        "left": "0",
                                        "top": "0",
                                        "width": "0",
                                        "height": "0"
                                    });
                                },
                                onChange: function (color) {
                                    //console.log("change", color)
                                },
                                //  确认
                                onConfirm: function (color) {
                                    //console.log("confirm", color) colors\visualMap\itemStyle\areaStyle
                                    var res = color.color.rgbav[3] !== "1" ? color.color.rgba : color.color.hex;
                                    var item_color = [], offset = 0, bk_color = [];
                                    var series_num = 0;
                                    //panelData[id].css[thiso.attr("css")] = res;
                                    switch (thiso.attr("css")) {
                                        case "background-color":
                                            thiso.find('input').val(res).css("background-color", res);
                                            $('div[panel-id="' + id + '"]').css(thiso.attr("css"), res);
                                            panelData[id].css[thiso.attr("css")] = res;
                                            panelData[id].css["background"] = panelData[id].css["background"] !== undefined ? panelData[id].css["background"].split("no-repeat")[0] + "no-repeat " + res : "none";
                                            break;
                                        case "colors":
                                            thiso.append('<span style="background-color:' + res + ';"></span>');
                                            colors.push(res);
                                            panelData[id].echarts["line"]["color"] = colors;
                                            break;
                                        case "visualMap":
                                            visualMap.push(res);
                                            if (panelData[id].echarts["line"]["visualMap"] === undefined) {
                                                panelData[id].echarts["line"]["visualMap"] = [{
                                                    show: false,
                                                    type: 'piecewise', // 定义为连续型 visualMap
                                                    seriesIndex: 0,
                                                    pieces: [{ gt: 0, lte: 50, color: panelData[id].echarts["line"]["color"][0] },
                                                    { gt: 50, color: visualMap[0] }]
                                                }];
                                            }
                                            for (var i = 1; i < visualMap.length; i++) {
                                                panelData[id].echarts["line"]["visualMap"].push({
                                                    show: false,
                                                    type: 'piecewise', // 定义为连续型 visualMap
                                                    seriesIndex: i,
                                                    pieces: [{ gt: 0, lte: 50, color: panelData[id].echarts["line"]["color"][visualMap.length - 1] },
                                                    { gt: 50, color: visualMap[visualMap.length - 1] }]
                                                });
                                                (i + 1) > panelData[id].echarts["line"]["series"].length ? panelData[id].echarts["line"]["series"].push(twx_prototype.deepClone(panelData[id].echarts["line"]["series"][0])) : "";
                                            }
                                            thiso.append('<span style="background-color:' + res + ';"></span>');
                                            break;
                                        case "itemStyle":
                                            series_num = panelData[id].echarts["line"]["series"].length - 1;
                                            itemStyle.push(res);
                                            if (panelData[id].echarts["line"]["series"][series_num]["itemStyle"] === undefined) {
                                                panelData[id].echarts["line"]["series"][series_num]["itemStyle"] = {
                                                    normal: {
                                                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1,
                                                            [{
                                                                offset: 0,
                                                                color: itemStyle[0]
                                                            }],
                                                            false
                                                        ),
                                                        borderColor: "rgba(221, 220, 107, .8)",
                                                        borderWidth: 12
                                                    }
                                                };
                                            }
                                            item_color.push({ offset: 0, color: itemStyle[0] });
                                            bk_color.push(itemStyle[0] + " 0%");
                                            for (var i = 1; i < itemStyle.length; i++) {
                                                offset = Math.round(parseInt(i / (itemStyle.length - 1) * 10)) / 10;
                                                item_color.push({ offset: offset, color: itemStyle[i] });
                                                bk_color.push(itemStyle[i] + " " + offset * 100 + "%");
                                            }
                                            panelData[id].echarts["line"]["series"][series_num]["itemStyle"]["normal"]["color"] = new echarts.graphic.LinearGradient(0, 0, 0, 1, item_color, false);
                                            thiso.find(".div-array").eq(series_num).css("background", 'linear-gradient(to right, ' + bk_color.join(',') + ')');
                                            break;
                                        case "areaStyle":
                                            series_num = panelData[id].echarts["line"]["series"].length - 1;
                                            areaStyle.push(res);
                                            if (panelData[id].echarts["line"]["series"][series_num]["areaStyle"] === undefined) {
                                                panelData[id].echarts["line"]["series"][series_num]["areaStyle"] = {
                                                    normal: {
                                                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1,
                                                            [{
                                                                offset: 0,
                                                                color: areaStyle[0]
                                                            }],
                                                            false
                                                        ),
                                                        shadowColor: "rgba(0, 0, 0, 0.1)"
                                                    }
                                                };
                                            }
                                            item_color.push({ offset: 0, color: areaStyle[0] });
                                            bk_color.push(areaStyle[0] + " 0%");
                                            for (var i = 1; i < areaStyle.length; i++) {
                                                offset = Math.round(parseInt(i / (areaStyle.length - 1) * 10)) / 10;
                                                item_color.push({ offset: offset, color: areaStyle[i] });
                                                bk_color.push(areaStyle[i] + " " + offset * 100 + "%");
                                            }
                                            panelData[id].echarts["line"]["series"][series_num]["areaStyle"]["normal"]["color"] = new echarts.graphic.LinearGradient(0, 0, 0, 1, item_color, false);
                                            thiso.find(".div-array").eq(series_num).css("background", 'linear-gradient(to right, ' + bk_color.join(',') + ')');
                                            break;
                                        default:
                                            break;
                                    }
                                    //  隐藏颜色标签
                                    $("#twx-color").css({
                                        "left": "0",
                                        "top": "0",
                                        "width": "0",
                                        "height": "0"
                                    });
                                }
                            });
                        });
                        //  隐藏颜色标签
                        $("#twx-color").on("mouseleave", function () {
                            if ($(".fcolorpicker").length === 0) {
                                //  隐藏颜色标签
                                $("#twx-color").css({
                                    "left": "0",
                                    "top": "0",
                                    "width": "0",
                                    "height": "0"
                                });
                            }
                        });

                        //  背景图
                        $('input[name="background"]').css("background", panelData[id].css["background"] !== undefined ? panelData[id].css["background"].split("no-repeat")[0].replace("100%", "auto") + "no-repeat" : "none");
                        $('input[name="background"]').on("click", function (e) {
                            //  弹出文件框
                            twx_popup.open({
                                //  层标题；默认值：标题
                                title: "图库"
                                //  右上关闭层按钮；默认值：true（显示关闭按钮）
                                , rightCloseBtn: true
                                //  *秒自动关闭层；默认值：5 秒
                                , time: 0
                                //  遮蔽罩；默认值：true（显示遮蔽罩，层其他位置不能点击）
                                , shade: true
                                //  按钮
                                , btn: ["确认", "取消"]
                                //  层区域大小
                                , area: ["600px", "500px"]
                                //  层内容
                                , content: $('.img-gallery-parent').html()
                                //  右侧点击回调
                                , func0: function (index, layero) {
                                    var src = 'url(' + $(".img-info").find(".active").find("img").attr("src") + ') center center / 100% 100% no-repeat';
                                    panelData[id].css["background"] = src + (panelData[id].css["background-color"] !== undefined ? ' ' + panelData[id].css["background-color"] : "");
                                    $('input[name="background"]').css("background", src.replace("100%", "auto"));
                                    $('div[panel-id="' + id + '"]').css("background", panelData[id].css["background"]);
                                    twx_popup.close(index);
                                }
                            });
                            //  图库列表
                            //$.fn.zTree.init($(".treeDemo"), setting, zNodes);
                            $(".img-info-img").on("click", function () {
                                var thiso = $(this);
                                $(".img-info-img").removeClass("active");
                                thiso.addClass("active");
                            });
                        });

                        //  列表框：图列对齐、图表数据、平滑曲线
                        $(".drop-ul-li").off("click").on("click", function () {
                            var thiso = $(this);
                            var input = thiso.parents(".drop-parent").find(".drop-input");
                            var value = thiso.attr("ul-li-type");
                            input.val(thiso.text());
                            input.attr("ul-li-type", value);
                            switch (input.attr('name')) {
                                //  图列对齐：居左、居中、居右
                                case "legend":
                                    delete panelData[id].echarts["line"]["legend"]["left"];
                                    delete panelData[id].echarts["line"]["legend"]["right"];
                                    switch (value) {
                                        case "left":
                                            panelData[id].echarts["line"]["legend"]["left"] = "2%";
                                            break;
                                        case "right":
                                            panelData[id].echarts["line"]["legend"]["right"] = "2%";
                                            break;
                                        default: break;
                                    }
                                    break;
                                //  折线、曲线
                                case "smooth":
                                    switch (value) {
                                        case "true":
                                            for (var i = 0; i < panelData[id].echarts["line"]["series"].length; i++) {
                                                panelData[id].echarts["line"]["series"][i]["smooth"] = true;
                                            }
                                            break;
                                        case "false":
                                            for (var i = 0; i < panelData[id].echarts["line"]["series"].length; i++) {
                                                panelData[id].echarts["line"]["series"][i]["smooth"] = false;
                                            }
                                            break;
                                        default: break;
                                    }
                                    break;
                                //  曲线数据显示、隐藏
                                case "showSymbol":
                                    switch (value) {
                                        case "true":
                                            for (var i = 0; i < panelData[id].echarts["line"]["series"].length; i++) {
                                                panelData[id].echarts["line"]["series"][i]["showSymbol"] = true;
                                            };
                                            break;
                                        case "false":
                                            for (var i = 0; i < panelData[id].echarts["line"]["series"].length; i++) {
                                                panelData[id].echarts["line"]["series"][i]["showSymbol"] = false;
                                            };
                                            break;
                                        default: break;
                                    }
                                    break;
                                default:
                                    break;
                            }
                        });

                        //  线宽
                        $('input[name="lineStyle-width"]').val(panelData[id].echarts["line"]["series"][0]["lineStyle"]["width"]);
                        $('input[name="lineStyle-width"]').on("input", function (e) {
                            var val = (new RegExp("^[0-9]*$")).test(e.delegateTarget.value) ? e.delegateTarget.value : 1;
                            $(this).val(val);
                            panelData[id].echarts["line"]["series"][0]["lineStyle"]["width"] = val;
                        });

                        //  文本设备绑定
                        $('.device-binding').on("click", function (e) {
                            var thiso = $(this);
                            var input = thiso.parents(".child").find("input");
                            //  zTree 数据
                            var treeObj;
                            //  弹出文件框
                            twx_popup.open({
                                //  层标题；默认值：标题
                                title: panelData[id]["panel-type"] === "menulist" ? "菜单列表" : "工程设备列表"
                                //  右上关闭层按钮；默认值：true（显示关闭按钮）
                                , rightCloseBtn: true
                                //  *秒自动关闭层；默认值：5 秒
                                , time: 0
                                //  遮蔽罩；默认值：true（显示遮蔽罩，层其他位置不能点击）
                                , shade: true
                                //  按钮
                                , btn: ["确认", "取消"]
                                //  层区域大小
                                , area: ["300px", "400px"]
                                //  层内容
                                , content: panelData[id]["panel-type"] === "menulist" ? $('.menu-list').html() : $('.device-list').html()
                                //  右侧点击回调
                                , func0: function (index, layero) {
                                    var nodes = treeObj.getCheckedNodes(true);
                                    var name = [], nos = [];
                                    switch (panelData[id]["panel-type"]) {
                                        case "menulist":
                                            panelData[id]["echarts"]["menulist"] = [];
                                            $.each(nodes, function (n, list) {
                                                panelData[id]["echarts"]["menulist"].push({
                                                    "id": list.id,
                                                    "pid": list.pId,
                                                    "name": list.name,
                                                    "icon": list.icons,
                                                    "class": list.class,
                                                    "href": list.href,
                                                    "panel": list.panel
                                                });
                                            });
                                            break;
                                        case "devicelist":
                                            panelData[id]["echarts"]["devicelist"] = [];
                                            $.each(nodes, function (n, list) {
                                                panelData[id]["echarts"]["devicelist"].push({
                                                    "id": list.id,
                                                    "pid": "00",
                                                    "name": list.name,
                                                    "class": "",
                                                    "href": ""
                                                });
                                            });
                                            break;
                                        case "spotlist":
                                            panelData[id]["echarts"]["spotlist"] = [];
                                            $.each(nodes, function (n, list) {
                                                panelData[id]["echarts"]["spotlist"].push({
                                                    "id": list.id,
                                                    "pid": "00",
                                                    "name": list.name,
                                                    "alarm": "正常",
                                                    "href": ""
                                                });
                                            });
                                            break;
                                        case "battery":
                                            panelData[id]["echarts"]["battery"] = [];
                                            $.each(nodes, function (n, list) {
                                                panelData[id]["echarts"]["battery"].push({
                                                    "id": list.id,
                                                    "pid": "00",
                                                    "title": "正常",
                                                    "name": list.name,
                                                    "src": "../../image/svg/pie.svg"
                                                });
                                            });
                                            break;
                                        default:
                                            $.each(nodes, function (n, list) {
                                                name.push(list.name);
                                                nos.push(list.id);
                                            });
                                            input.val(name.join(','));
                                            panelData[id]["deviceNo"] = nos.join(',');
                                            panelData[id]["deviceNm"] = name.join(',');
                                            $('div[panel-id="' + id + '"]').find(".panel-twx-table").text(name[0]);
                                            panelData[id].text = name[0];
                                            break;
                                    }
                                    twx_popup.close(index);
                                }
                            });
                            switch (panelData[id]["panel-type"]) {
                                case "menulist":
                                    //  菜单列表
                                    treeObj = $.fn.zTree.init($(".treeMenu"), settingMenu, JSON.parse(sessionStorage.getItem("DataMenu")));
                                    break;
                                default:
                                    //  工程设备列表
                                    treeObj = $.fn.zTree.init($(".treeDevice"), settingDevice, JSON.parse(sessionStorage.getItem("DataEquip")));
                                    break;
                            }
                        });
                        break;
                    default:
                        break;
                }
            },
            //  右键标签内容
            rightLabel: '<div id="right-menu" oncontextmenu="return false"><table><tbody><tr class="menu-item" id="menu-copy"><td>复制</td></tr><tr class="menu-item" id="menu-del"><td>删除</td></tr><tr><td><hr /></td></tr><tr class="menu-item" id="menu-top"><td>移至最前</td></tr><tr class="menu-item" id="menu-pre"><td>移至前一级</td></tr><tr class="menu-item" id="menu-next"><td>移至下一级</td></tr><tr class="menu-item" id="menu-last"><td>移至最后</td></tr><tr><td><hr /></td></tr><tr class="menu-item"><td>保存到项目库</td></tr><tr class="menu-item" id="menu-field"><td>属性</td></tr></tbody></table></div>',
            //  标签复制
            menuCopy: function (id) {
                document.getElementById('right-menu').remove();
                //  考虑组合的控件
                var groupFunc = function (newID, data) {
                    var newData = twx_prototype.deepClone(data);
                    if (newData["panel-type"] === "group") {
                        newData["children"] = [];
                        var children = data["children"];
                        for (var i = 0; i < children.length; i++) {
                            newData["children"].push(newID + "-" + i);
                            var childData = twx_prototype.deepClone(panelData[children[i]]);
                            childData.css.top = (parseInt(childData.css.top) + parseInt(newData.css.top)) + "px";
                            childData.css.left = (parseInt(childData.css.left) + parseInt(newData.css.left)) + "px";
                            groupFunc(newID + "-" + i, childData);
                        }
                    }
                    //  编辑框内：根据标签属性判断
                    twxui_editor.getDrawPage("#panel-draw", newData, {
                        "id": newID,
                        "left": parseInt(newData.css.left) + 10,
                        "top": parseInt(newData.css.top) + 10
                    }, false);
                }
                var copyID = new Date().getTime();
                groupFunc(copyID, panelData[id]);
                //  选中复制的新控件
                $('div[panel-id="' + id + '"]').find(".panel-twx-edit").remove();
                $('div[panel-id="' + id + '"]').removeClass("panel-twx-sel");
                $('div[panel-id="' + copyID + '"]').addClass("panel-twx-sel");
                $('div[panel-id="' + copyID + '"]').append(twxEditor.panelEditor);
                //  记录面板当前的状态
                twxTool.savePre();
            },
            //  标签删除
            menuDel: function (id) {
                document.getElementById('right-menu').remove();
                //  考虑组合的控件
                var groupFunc = function (newID) {
                    if (panelData[newID]["panel-type"] === "group") {
                        var ids = panelData[newID]["children"];
                        for (var i = 0; i < ids.length; i++) {
                            groupFunc(ids[i]);
                        }
                    }
                    $('div[panel-id="' + newID + '"]').remove();
                    //  删除文本中此标签的数据信息
                    delete panelData[newID];
                }
                groupFunc(id);
                //  记录面板当前的状态
                twxTool.savePre();
            },
            //  标签移至最前【最上一层】
            menuTop: function (id) {
                document.getElementById('right-menu').remove();
                //  panelData 按照 z-index 升序排序（排除组合内的控件ID）
                var childID = [];
                var groupFunc = function (data) {
                    $.each(data, function (n, list) {
                        if (list["panel-type"] === "group") {
                            childID = childID.concat(list["children"]);
                            var objChild = {};
                            for (var i = 0; i > list["children"].length; i++) {
                                objChild[list["children"][i]] = panelData[list["children"][i]];
                            }
                            groupFunc(objChild);
                        }
                    });
                }
                groupFunc(panelData);
                var objId = {};
                $.each(panelData, function (n, list) {
                    //  排除不可选控件
                    if (childID.indexOf(n) === -1 && !list.select && n !== "page-config") {
                        objId[list.css["z-index"]] = n;
                    }
                });
                var sort = Object.keys(objId).sort(function (a, b) { return a - b });
                //  重新排序：选中的 id 放到最上方【z-index 为最大值】
                var objzIndex = [];
                for (var i = 0; i < sort.length; i++) {
                    if (objId[sort[i]] !== id + "") {
                        objzIndex.push(objId[sort[i]]);
                    }
                }
                objzIndex.push(id);
                //  更新 panelData 的 z-index
                for (var i = 0; i < objzIndex.length; i++) {
                    panelData[objzIndex[i]].css["z-index"] = sort[i];
                    $('div[panel-id="' + objzIndex[i] + '"]').css("z-index", sort[i]);
                }
                //  记录面板当前的状态
                twxTool.savePre();
            },
            //  标签移至前一级【向上对调】
            menuPre: function (id) {
                document.getElementById('right-menu').remove();
                //  panelData 按照 z-index 升序排序（排除组合内的控件ID）
                var childID = [];
                var groupFunc = function (data) {
                    $.each(data, function (n, list) {
                        if (list["panel-type"] === "group") {
                            childID = childID.concat(list["children"]);
                            var objChild = {};
                            for (var i = 0; i > list["children"].length; i++) {
                                objChild[list["children"][i]] = panelData[list["children"][i]];
                            }
                            groupFunc(objChild);
                        }
                    });
                }
                groupFunc(panelData);
                var objId = {};
                $.each(panelData, function (n, list) {
                    //  排除不可选控件
                    if (childID.indexOf(n) === -1 && !list.select && n !== "page-config") {
                        objId[list.css["z-index"]] = n;
                    }
                });
                var sort = Object.keys(objId).sort(function (a, b) { return a - b });
                //  重新排序：选中的 id 放到最上方【z-index 为最大值】
                for (var i = 0; i < sort.length; i++) {
                    if (objId[sort[i]] === id + "" && i !== sort.length - 1) {
                        //  更新 panelData 的 z-index
                        var nowId = objId[sort[i]];
                        var nextId = objId[sort[i + 1]];
                        var nowIndex = panelData[nowId].css["z-index"];
                        var nextIndex = panelData[nextId].css["z-index"];
                        panelData[nowId].css["z-index"] = nextIndex;
                        $('div[panel-id="' + nowId + '"]').css("z-index", nextIndex);
                        panelData[nextId].css["z-index"] = nowIndex;
                        $('div[panel-id="' + nextId + '"]').css("z-index", nowIndex);
                    }
                }
                //  记录面板当前的状态
                twxTool.savePre();
            },
            //  标签移至后一级【向下对调】
            menuNext: function (id) {
                document.getElementById('right-menu').remove();
                //  panelData 按照 z-index 升序排序（排除组合内的控件ID）
                var childID = [];
                var groupFunc = function (data) {
                    $.each(data, function (n, list) {
                        if (list["panel-type"] === "group") {
                            childID = childID.concat(list["children"]);
                            var objChild = {};
                            for (var i = 0; i > list["children"].length; i++) {
                                objChild[list["children"][i]] = panelData[list["children"][i]];
                            }
                            groupFunc(objChild);
                        }
                    });
                }
                groupFunc(panelData);
                var objId = {};
                $.each(panelData, function (n, list) {
                    //  排除不可选控件
                    if (childID.indexOf(n) === -1 && !list.select && n !== "page-config") {
                        objId[list.css["z-index"]] = n;
                    }
                });
                var sort = Object.keys(objId).sort(function (a, b) { return a - b });
                //  重新排序：选中的 id 放到最上方【z-index 为最大值】
                for (var i = 0; i < sort.length; i++) {
                    if (objId[sort[i]] === id + "" && i !== 0) {
                        //  更新 panelData 的 z-index
                        var nowId = objId[sort[i]];
                        var preId = objId[sort[i - 1]];
                        var nowIndex = panelData[nowId].css["z-index"];
                        var preIndex = panelData[preId].css["z-index"];
                        panelData[nowId].css["z-index"] = preIndex;
                        $('div[panel-id="' + nowId + '"]').css("z-index", preIndex);
                        panelData[preId].css["z-index"] = nowIndex;
                        $('div[panel-id="' + preId + '"]').css("z-index", nowIndex);
                    }
                }
                //  记录面板当前的状态
                twxTool.savePre();
            },
            //  标签移至最后【最下一层】
            menuLast: function (id) {
                document.getElementById('right-menu').remove();
                //  panelData 按照 z-index 升序排序（排除组合内的控件ID）
                var childID = [];
                var groupFunc = function (data) {
                    $.each(data, function (n, list) {
                        if (list["panel-type"] === "group") {
                            childID = childID.concat(list["children"]);
                            var objChild = {};
                            for (var i = 0; i > list["children"].length; i++) {
                                objChild[list["children"][i]] = panelData[list["children"][i]];
                            }
                            groupFunc(objChild);
                        }
                    });
                }
                groupFunc(panelData);
                var objId = {};
                $.each(panelData, function (n, list) {
                    //  排除不可选控件
                    if (childID.indexOf(n) === -1 && !list.select && n !== "page-config") {
                        objId[list.css["z-index"]] = n;
                    }
                });
                var sort = Object.keys(objId).sort(function (a, b) { return a - b });
                //  重新排序：选中的 id 放到最上方【z-index 为最大值】
                var objzIndex = [id];
                for (var i = 0; i < sort.length; i++) {
                    if (objId[sort[i]] !== id + "") {
                        objzIndex.push(objId[sort[i]]);
                    }
                }
                //  更新 panelData 的 z-index
                for (var i = 0; i < objzIndex.length; i++) {
                    panelData[objzIndex[i]].css["z-index"] = sort[i];
                    $('div[panel-id="' + objzIndex[i] + '"]').css("z-index", sort[i]);
                }
                //  记录面板当前的状态
                twxTool.savePre();
            },
            //  属性
            menuField: function (id) {
                document.getElementById('right-menu').remove();
                //  如果当前属性类型不存在，则展开默认的属性
                $('.panel-field-info[panel-type="panel-common"]').addClass("open");
                //  动态配置
                switch (panelData[id]["panel-type"]) {
                    case "group":
                    case "wenshidu":
                    case "wenshidu2":
                    case "wenshidu2-1":
                    case "wenshidu3":
                    case "bar1":
                    case "menulist":
                    case "devicelist":
                    case "spotlist":
                    case "event":
                    case "battery":
                    case "hisdata":
                    case "input":
                    case "txt":
                        twx_popup.open({
                            //  层标题；默认值：标题
                            title: "基础属性"
                            //  右上关闭层按钮；默认值：true（显示关闭按钮）
                            , rightCloseBtn: true
                            //  *秒自动关闭层；默认值：5 秒
                            , time: 0
                            //  遮蔽罩；默认值：true（显示遮蔽罩，层其他位置不能点击）
                            , shade: true
                            //  按钮
                            , btn: ["检查", "确认", "取消"]
                            //  层区域大小
                            , area: ["400px", "auto"]
                            //  层内容
                            , content: $("#view-attr").html()
                            //  右侧点击回调
                            , cancel: function (index, layero) {
                                twx_popup.close(index);
                                if (JSON.stringify(panelData) !== JSON.stringify(panelDataHistory[panelDataHistory.length - 1])) {
                                    //  记录面板当前的状态
                                    twxTool.savePre();
                                }
                            }
                            , func1: function (index, layero) {
                                twx_popup.close(index);
                                if (JSON.stringify(panelData) !== JSON.stringify(panelDataHistory[panelDataHistory.length - 1])) {
                                    //  记录面板当前的状态
                                    twxTool.savePre();
                                }
                            }
                        });
                        break;
                    case "line":
                        twx_popup.open({
                            //  层标题；默认值：标题
                            title: "曲线属性"
                            //  右上关闭层按钮；默认值：true（显示关闭按钮）
                            , rightCloseBtn: true
                            //  *秒自动关闭层；默认值：5 秒
                            , time: 0
                            //  遮蔽罩；默认值：true（显示遮蔽罩，层其他位置不能点击）
                            , shade: true
                            //  按钮
                            , btn: ["确认", "取消"]
                            //  层区域大小
                            , area: ["400px", "auto"]
                            //  层内容
                            , content: $("#view-echarts-line").html()
                            //  右侧点击回调
                            , cancel: function (index, layero) {
                                twx_popup.close(index);
                                if (JSON.stringify(panelData) !== JSON.stringify(panelDataHistory[panelDataHistory.length - 1])) {
                                    //  记录面板当前的状态
                                    twxTool.savePre();
                                }
                            }
                            , func0: function (index, layero) {
                                twx_popup.close(index);
                                if (JSON.stringify(panelData) !== JSON.stringify(panelDataHistory[panelDataHistory.length - 1])) {
                                    //  记录面板当前的状态
                                    twxTool.savePre();
                                }
                            }
                        });
                        break;
                    default:
                        break;
                }
                rightMenu.field();
            },
            //  下级菜单跟随鼠标展示
            menuChild: function () {
                var hover = $(".hover-body");
                hover.off("click").on("click", function (e) {
                    var e = e || window.event;
                    var thiso = $(this);
                    var newID = 'body-' + new Date().getTime();
                    switch (thiso.attr("hover-type")) {
                        //  动画子级
                        case "animation":
                            $("body").append('<div id="' + newID + '" class="body-div" style="left:' + (e.clientX - e.offsetX) + "px;top:" + (e.clientY - e.offsetY + thiso.height()) + "px;width:" + thiso.width() + 'px;"><ul class="body-ul"><li class-type="up-down">上下跳动</li><li class-type="left-right">左右摇摆</li><li class-type="heartbeat">心跳</li><li class-type="fade-in-out">闪烁</li><li class-type="rotate-circle">旋转</li><li class-type="login-exit">退出登录</li></ul></div>');
                            $("#" + newID).on("mouseleave", function () {
                                $("#" + newID).remove();
                            });
                            $("#" + newID).find(".body-ul li").on("click", function () {
                                var childo = $(this);
                                thiso.find("input").attr("class-type", childo.attr("class-type")).val(childo.text());
                                $("#" + newID).remove();
                                $(".event-animation").attr("class-type", childo.attr("class-type")).val(childo.text());
                            });
                            break;
                        //  字体对齐子级
                        case "font-align":
                            $("body").append('<div id="' + newID + '" class="body-div" style="left:' + (e.clientX - e.offsetX) + "px;top:" + (e.clientY - e.offsetY + thiso.height()) + "px;width:" + thiso.width() + 'px;"><ul class="body-ul"><li ul-li-type="justify-content:space-around">居中</li><li ul-li-type="justify-content:flex-start">左对齐</li><li ul-li-type="justify-content:flex-end">右对齐</li></ul></div>');
                            $("#" + newID).on("mouseleave", function () {
                                $("#" + newID).remove();
                            });
                            $("#" + newID).find(".body-ul li").on("click", function () {
                                var childo = $(this);
                                thiso.find("input").attr("ul-li-type", childo.attr("ul-li-type")).val(childo.text());
                                $("#" + newID).remove();
                            });
                            break;
                        //  字体字形子级
                        case "font-style":
                            $("body").append('<div id="' + newID + '" class="body-div" style="left:' + (e.clientX - e.offsetX) + "px;top:" + (e.clientY - e.offsetY + thiso.height()) + "px;width:" + thiso.width() + 'px;"><ul class="body-ul"><li class="drop-ul-li" ul-li-type="font-weight:normal;font-style:normal" style="font-weight:normal;font-style:normal;">常规</li><li class="drop-ul-li" ul-li-type="font-weight:bolder" style="font-weight:bolder;">加粗</li><li class="drop-ul-li" ul-li-type="font-style:oblique" style="font-style:oblique;">倾斜</li><li class="drop-ul-li" ul-li-type="font-weight:bolder;font-style:oblique"><span style="font-weight:bolder;">加粗</span><span style="font-style:oblique;">倾斜</span></li></ul></div>');
                            $("#" + newID).on("mouseleave", function () {
                                $("#" + newID).remove();
                            });
                            $("#" + newID).find(".body-ul li").on("click", function () {
                                var childo = $(this);
                                thiso.find("input").attr("ul-li-type", childo.attr("ul-li-type")).val(childo.text());
                                $("#" + newID).remove();
                            });
                            break;
                        default:
                            break;
                    }
                });
            }
        };
        //  面板标签
        var panelAll = {
            //  标签所有关联
            init: function () {
                panelAll.defaultEvent();
                //  系统的标签
                panelAll.getPanelLabel("panelLabel");
                //  系统的项目
                panelAll.getPanelProject("panelProject");
                //  标签属性工具
                twxTool.init();
            }
            //  系统默认事件
            , defaultEvent: function () {
                //  页面尺寸
                $(".panel-page").find("input").on("input", function (e) {
                    panelData.config[$(this).attr("type-name")] = e.target.value;
                    $("#panel-draw").css({ "width": panelData.config.width + "px", "height": panelData.config.height + "px" });
                });
                $(".page-size").find("li").on("click", function () {
                    var el = $(this).parents("li").next().find("input");
                    var val = $(this).text().split("×");
                    el.eq(0).val(val[0]);
                    el.eq(1).val(val[1]);
                    panelData.config.width = val[0];
                    panelData.config.height = val[1];
                    $("#panel-draw").css({ "width": panelData.config.width + "px", "height": panelData.config.height + "px" });
                });
            }
            //  页面数据：系统面板创建的项目
            , getPanelPage: function (fileNm) {
                var newID = twxEditor.layerLoad();
                $.ajax({
                    url: '../Files/Project/' + fileNm + '.txt',
                    type: "get",
                    datatype: "json",
                    success: function (data) {
                        panelData = JSON.parse(data);
                        //  绘制画板内容
                        $("#panel-draw").css({ "width": panelData.config.width + "px", "height": panelData.config.height + "px" });
                        $(".twx-header").find("input").eq(0).val(panelData.config.width);
                        $(".twx-header").find("input").eq(1).val(panelData.config.height);
                        $(".panel-page").css("visibility", "visible");
                        newID.remove();
                    },
                    error: function () {
                        //  绘制画板内容
                        panelData = {};
                        $("#panel-draw").css({ "width": "0", "height": "0" });
                        $(".twx-header").find("input").val(0);
                        $(".panel-page").css("visibility", "hidden");
                        newID.remove();
                    }
                });
            }
            //  集成标签：系统面板控件属性
            , panelLabel: function (data) {
                var arr = twxAll.getChildren(data, "twx");
                var divAll = "";
                $.each(arr, function (n, list) {
                    divAll += '<div class="panel"><div class="panel-name"><i class="fa fa-tags"></i><span>' + list.title + '</span></div><div class="panel-info">';
                    $.each(list.children, function (n1, list1) {
                        divAll += '<div class="child" panel-type="' + list1.type + '" title="' + list1.title + '"><img src="../Images/svg/' + list1.img + '"></div>';
                    });
                    divAll += '</div></div>';
                });
                $("#drag-panel").append(divAll);
                //  绑定标签拖拽效果
                twxEditor.panelDrag();
            }
            //  系统面板控件属性：根据不同的控件类型，获取指定的控件内容
            , getPanelLabel: function (fileNm) {
                $.ajax({
                    url: '../Files/Panel/' + fileNm + '.txt',
                    type: "get",
                    datatype: "json",
                    success: function (data) {
                        panelAll.panelLabel(JSON.parse(data));
                    }
                });
            }
            //  集成标签：系统面板创建的项目
            , panelProject: function (data) {
                var span = '<span class="span-hover"><i class="fa fa-pencil fa-hover" type-name="edit"></i><i class="fa fa-trash-o fa-hover" type-name="del"></i></span>';
                var arr = twxAll.getChildren(data, "twx");
                var divAll = "";
                $.each(arr, function (n, list) {
                    divAll += '<div class="panel-project"><div class="panel-name panel-flex"><span><i class="fa fa-suitcase"></i><span>' + list.title + '</span></span><i class="fa fa-plus fa-hover" type-name="add"></i></div><div class="panel-info">';
                    $.each(list.children, function (n1, list1) {
                        divAll += '<div class="child" type-name="' + list1.id + '"><span><i class="fa fa-terminal"></i><span class="span-input">' + list1.title + '</span></span>' + span + '</div>';
                    });
                    divAll += '</div></div>';
                });
                $("#project-panel").append(divAll);
                //  点击按钮
                var faClick = function () {
                    $(".panel-project").find(".fa-hover").off("click").on("click", function (ev) {
                        var e = ev || window.event;
                        //  阻止冒泡事件
                        e.stopPropagation();
                        var thiso = $(this);
                        switch (thiso.attr("type-name")) {
                            //  项目创建
                            case "add":
                                $("#project-panel").find(".panel-info").prepend('<div class="child"><span><i class="fa fa-terminal"></i><span class="span-input"><input type="text" value="" autocomplete="off" /></span></span></div>');
                                $(".span-input").find("input").val("自定义新页面").focus().on("blur", function () {
                                    var obj = $(this);
                                    $(".panel-project").find(".child").removeClass("select");
                                    obj.parents(".child").append(span).addClass("select");
                                    obj.parent().html(obj.val());
                                    faClick();
                                    //  创建新的页面
                                    panelData = {
                                        "config": {
                                            "width": "1366",
                                            "height": "768"
                                        },
                                        "data": {}
                                    };
                                    $("#panel-draw").css({ "width": panelData.config.width + "px", "height": panelData.config.height + "px" });
                                    $(".twx-header").find("input").eq(0).val(panelData.config.width);
                                    $(".twx-header").find("input").eq(1).val(panelData.config.height);
                                    $(".panel-page").css("visibility", "visible");
                                });
                                break;
                            //  名称编辑
                            case "edit":
                                thiso.parents(".child").find(".span-input").html(function () {
                                    var val = $(this).text();
                                    $(this).html('<input type="text" value="" autocomplete="off" />');
                                    thiso.parents(".child").find(".span-hover").remove();
                                    $(this).find("input").val(val).focus().on("blur", function () {
                                        var obj = $(this);
                                        obj.parents(".child").append(span);
                                        obj.parent().html(obj.val());
                                        faClick();
                                    });
                                    $(this).find("input").on("click", function (event) {
                                        var ev = event || window.event;
                                        //  阻止冒泡事件
                                        ev.stopPropagation();
                                    });
                                });
                                break;
                            //  页面删除
                            case "del":
                                var winbox = twxEditor.layer({ title: "提示", width: "340px", height: "180px", div: '<div class="panel-layout"><div class="layer-body">确认要删除页面吗？</div><div class="layer-btn" style=""><span btn-type="sure">确定</span><span btn-type="cancel">取消</span></div></div>' });
                                $(".panel-layout").find(".layer-btn").find("span").off("click").on("click", function () {
                                    switch ($(this).attr("btn-type")) {
                                        case "sure":
                                            thiso.parents(".child").remove();
                                            //  绘制画板内容
                                            panelData = {};
                                            $("#panel-draw").css({ "width": "0", "height": "0" });
                                            $(".twx-header").find("input").val(0);
                                            $(".panel-page").css("visibility", "hidden");
                                            break;
                                        default: break;
                                    }
                                    winbox.close();
                                });
                                break;
                            default: break;
                        }
                    });
                    $(".panel-project").find(".child").off("click").on("click", function () {
                        $(".panel-project").find(".child").removeClass("select");
                        $(this).addClass("select");
                        //  获取指定的页面数据
                        panelAll.getPanelPage($(this).attr("type-name"));
                    });
                }
                faClick();
            }
            //  系统面板创建的项目
            , getPanelProject: function (fileNm) {
                $.ajax({
                    url: '../Files/Panel/' + fileNm + '.txt',
                    type: "get",
                    datatype: "json",
                    success: function (data) {
                        panelAll.panelProject(JSON.parse(data));
                    }
                });
            }
        };
        $(function () {
            panelAll.init();
        });
    </script>
</body>
</html>